{"version":3,"sources":["../../../../src/services/organization/organizer/create-organizer.ts"],"names":["createOrganizer","userId","insertOrganization","db","organization","insertOrganizer","organizer","user","eq"],"mappings":"6HAIA,eAAsBA,CAAgBC,CAAAA,CAAAA,CAAgB,CACpD,MAAMC,CAAqB,CAAA,MAAMC,CAC9B,CAAA,MAAA,CAAOC,YAAY,CAAA,CACnB,MAAO,CAAA,CACN,KAAM,iBACR,CAAC,CACA,CAAA,SAAA,EAEH,CAAA,GAAI,CAACF,CAAmB,CAAA,CAAC,CACvB,CAAA,MAAM,IAAI,KAAA,CAAM,+BAA+B,CAGjD,CAAA,MAAMG,CAAkB,CAAA,MAAMF,CAC3B,CAAA,MAAA,CAAOG,SAAS,CAAA,CAChB,MAAO,CAAA,CACN,cAAgBJ,CAAAA,CAAAA,CAAmB,CAAC,CAAA,CAAE,GACtC,MAAAD,CAAAA,CAAAA,CACA,KAAO,CAAA,OACT,CAAC,CAAA,CACA,WAEH,CAAA,GAAI,CAACI,CAAAA,CAAgB,CAAC,CAAA,CACpB,MAAM,IAAI,KAAA,CAAM,4BAA4B,CAAA,CAU9C,GAAI,CAPe,MAAMF,CAAAA,CACtB,MAAOI,CAAAA,IAAI,CACX,CAAA,GAAA,CAAI,CACH,mBAAA,CAAqBF,EAAgB,CAAC,CAAA,CAAE,EAC1C,CAAC,CACA,CAAA,KAAA,CAAMG,EAAGD,CAAAA,IAAAA,CAAK,EAAIN,CAAAA,CAAM,CAAC,CAAA,CAG1B,MAAM,IAAI,MAAM,uBAAuB,CAAA,CAGzC,OAAO,CAAE,GAAGI,CAAAA,CAAgB,CAAC,CAAA,CAAG,YAAcH,CAAAA,CAAAA,CAAmB,CAAC,CAAE,CACtE","file":"create-organizer.js","sourcesContent":["import db from \"../../../lib/db\";\nimport { organization, organizer, user } from \"../../../lib/db/schema\";\nimport { eq } from \"drizzle-orm\";\n\nexport async function createOrganizer(userId: string) {\n  const insertOrganization = await db\n    .insert(organization)\n    .values({\n      name: \"My Organization\",\n    })\n    .returning();\n\n  if (!insertOrganization[0]) {\n    throw new Error(\"Failed to create organization\");\n  }\n\n  const insertOrganizer = await db\n    .insert(organizer)\n    .values({\n      organizationId: insertOrganization[0].id,\n      userId,\n      level: \"owner\",\n    })\n    .returning();\n\n  if (!insertOrganizer[0]) {\n    throw new Error(\"Failed to create organizer\");\n  }\n\n  const updateUser = await db\n    .update(user)\n    .set({\n      selectedOrganizerId: insertOrganizer[0].id,\n    })\n    .where(eq(user.id, userId));\n\n  if (!updateUser) {\n    throw new Error(\"Failed to update user\");\n  }\n\n  return { ...insertOrganizer[0], organization: insertOrganization[0] };\n}\n"]}