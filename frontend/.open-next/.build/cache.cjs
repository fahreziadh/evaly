globalThis.disableIncrementalCache = false;globalThis.disableDynamoDBCache = false;globalThis.isNextAfter15 = true;globalThis.openNextDebug = false;globalThis.openNextVersion = "3.4.1";
var m=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var w=Object.getOwnPropertyNames;var C=Object.prototype.hasOwnProperty;var y=(a,t)=>{for(var e in t)m(a,e,{get:t[e],enumerable:!0})},N=(a,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of w(t))!C.call(a,i)&&i!==e&&m(a,i,{get:()=>t[i],enumerable:!(s=_(t,i))||s.enumerable});return a};var E=a=>N(m({},"__esModule",{value:!0}),a);var R={};y(R,{default:()=>g});module.exports=E(R);var P=new Set(["application/octet-stream","application/epub+zip","application/msword","application/pdf","application/rtf","application/vnd.amazon.ebook","application/vnd.ms-excel","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.openxmlformats-officedocument.wordprocessingml.document","font/otf","font/woff","font/woff2","image/bmp","image/gif","image/jpeg","image/png","image/tiff","image/vnd.microsoft.icon","image/webp","audio/3gpp","audio/aac","audio/basic","audio/flac","audio/mpeg","audio/ogg","audio/wavaudio/webm","audio/x-aiff","audio/x-midi","audio/x-wav","video/3gpp","video/mp2t","video/mpeg","video/ogg","video/quicktime","video/webm","video/x-msvideo","application/java-archive","application/vnd.apple.installer+xml","application/x-7z-compressed","application/x-apple-diskimage","application/x-bzip","application/x-bzip2","application/x-gzip","application/x-java-archive","application/x-rar-compressed","application/x-tar","application/x-zip","application/zip","application/x-protobuf"]);function b(a){if(!a)return!1;let t=a?.split(";")[0]??"";return P.has(t)}function h(a){try{return"__openNextInternal"in a}catch{return!1}}function l(...a){globalThis.openNextDebug&&console.log(...a)}function T(...a){console.warn(...a)}var A=[{clientName:"S3Client",commandName:"GetObjectCommand",errorName:"NoSuchKey"}],L=a=>A.some(t=>t.clientName===a?.clientName&&t.commandName===a?.commandName&&(t.errorName===a?.error?.name||t.errorName===a?.error?.Code));function v(...a){if(a.some(t=>L(t)))return l(...a);if(a.some(t=>h(t))){let t=a.find(e=>h(e));return t.logLevel<I()?void 0:t.logLevel===0?console.log(...a.map(e=>h(e)?`${e.name}: ${e.message}`:e)):t.logLevel===1?T(...a.map(e=>h(e)?`${e.name}: ${e.message}`:e)):console.error(...a)}console.error(...a)}function I(){switch((process.env.OPEN_NEXT_ERROR_LOG_LEVEL??"1").toLowerCase()){case"debug":case"0":return 0;case"error":case"2":return 2;default:return 1}}function M(a){return typeof a=="boolean"?a:typeof a=="object"?a.kindHint==="fetch"||a.fetchCache||a.kind==="FETCH":!1}var g=class{async get(t,e){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return null;let s=typeof e=="object"?e.softTags:[],i=typeof e=="object"?e.tags:[];return M(e)?this.getFetchCache(t,s,i):this.getIncrementalCache(t)}async getFetchCache(t,e,s){l("get fetch cache",{key:t,softTags:e,tags:s});try{let{value:i,lastModified:n}=await globalThis.incrementalCache.get(t,!0),r=await globalThis.tagCache.getLastModified(t,n);if(r===-1||i===void 0)return null;if((s??[]).length===0){let p=e?.find(o=>o.startsWith("_N_T_/")&&!o.endsWith("layout")&&!o.endsWith("page"));if(p&&await globalThis.tagCache.getLastModified(p.replace("_N_T_/",""),n)===-1)return null}return{lastModified:r,value:i}}catch(i){return l("Failed to get fetch cache",i),null}}async getIncrementalCache(t){try{let{value:e,lastModified:s}=await globalThis.incrementalCache.get(t,!1),i=e?.meta,n=await globalThis.tagCache.getLastModified(t,s);if(n===-1)return null;let r=globalThis.__openNextAls.getStore()?.requestId??"";return globalThis.lastModified[r]=n,e?.type==="route"?{lastModified:n,value:{kind:globalThis.isNextAfter15?"APP_ROUTE":"ROUTE",body:Buffer.from(e.body??Buffer.alloc(0),b(String(i?.headers?.["content-type"]))?"base64":"utf8"),status:i?.status,headers:i?.headers}}:e?.type==="page"||e?.type==="app"?globalThis.isNextAfter15&&e?.type==="app"?{lastModified:n,value:{kind:"APP_PAGE",html:e.html,rscData:Buffer.from(e.rsc),status:i?.status,headers:i?.headers,postponed:i?.postponed}}:{lastModified:n,value:{kind:globalThis.isNextAfter15?"PAGES":"PAGE",html:e.html,pageData:e.type==="page"?e.json:e.rsc,status:i?.status,headers:i?.headers}}:e?.type==="redirect"?{lastModified:n,value:{kind:"REDIRECT",props:e.props}}:(T("Unknown cache type",e),null)}catch(e){return l("Failed to get body cache",e),null}}async set(t,e,s){if(globalThis.openNextConfig.dangerous?.disableIncrementalCache)return;let i=globalThis.__openNextAls.getStore()?.pendingPromiseRunner.withResolvers();try{if(e==null)await globalThis.incrementalCache.delete(t);else switch(e.kind){case"ROUTE":case"APP_ROUTE":{let{body:o,status:d,headers:f}=e;await globalThis.incrementalCache.set(t,{type:"route",body:o.toString(b(String(f["content-type"]))?"base64":"utf8"),meta:{status:d,headers:f}},!1);break}case"PAGE":case"PAGES":{let{html:o,pageData:d,status:f,headers:c}=e;typeof d=="string"?await globalThis.incrementalCache.set(t,{type:"app",html:o,rsc:d,meta:{status:f,headers:c}},!1):await globalThis.incrementalCache.set(t,{type:"page",html:o,json:d},!1);break}case"APP_PAGE":{let{html:o,rscData:d,headers:f,status:c}=e;await globalThis.incrementalCache.set(t,{type:"app",html:o,rsc:d.toString("utf8"),meta:{status:c,headers:f}},!1);break}case"FETCH":await globalThis.incrementalCache.set(t,e,!0);break;case"REDIRECT":await globalThis.incrementalCache.set(t,{type:"redirect",props:e.props},!1);break;case"IMAGE":break}let n=e?.kind==="FETCH"?s?.tags??e?.data?.tags??[]:e?.kind==="PAGE"?e.headers?.["x-next-cache-tags"]?.split(",")??[]:[];l("derivedTags",n);let r=await globalThis.tagCache.getByPath(t),p=n.filter(o=>!r.includes(o));p.length>0&&await globalThis.tagCache.writeTags(p.map(o=>({path:t,tag:o,revalidatedAt:1}))),l("Finished setting cache")}catch(n){v("Failed to set cache",n)}finally{i?.resolve()}}async revalidateTag(t){let e=globalThis.openNextConfig.dangerous;if(!(e?.disableTagCache||e?.disableIncrementalCache))try{let s=Array.isArray(t)?t:[t];for(let i of s){l("revalidateTag",i);let n=await globalThis.tagCache.getByTag(i);l("Items",n);let r=n.map(o=>({path:o,tag:i}));if(i.startsWith("_N_T_/"))for(let o of n){let f=(await globalThis.tagCache.getByPath(o)).filter(c=>!c.startsWith("_N_T_/"));for(let c of f){let u=await globalThis.tagCache.getByTag(c);l({hardTag:c,_paths:u}),r.push(...u.map(x=>({path:x,tag:c})))}}await globalThis.tagCache.writeTags(r);let p=Array.from(new Set(r.filter(o=>o.tag.startsWith("_N_T_/")).map(o=>`/${o.path}`)));p.length>0&&await globalThis.cdnInvalidationHandler.invalidatePaths(p.map(o=>({initialPath:o,rawPath:o,resolvedRoutes:[{route:o,type:"app"}]})))}}catch(s){v("Failed to revalidate tag",s)}}};
