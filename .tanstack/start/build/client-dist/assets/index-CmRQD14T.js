import{d as ye,ab as Ce,r as C,a2 as de,j as t,k as q,B as w,i as ue,$ as pe,f as Oe,g as E,h as he,V as ke,b as Ne,o as Te,T as Ie}from"./main-Cf9OxwIv.js";import{P as Se,a as qe,b as Pe,u as Ae,d as _,E as ze,f as U,g as $,C as Ee,h as H}from"./editor-DLIFMkF6.js";import{S as _e}from"./separator-CaSlYSmw.js";import{I as me}from"./input-CmcoE0j1.js";import{b as Re,d as Le}from"./index-GxXN4R5W.js";import{c as Ve}from"./index-tmSglm_A.js";import{u as De}from"./index-C38j2yiJ.js";import{P as xe}from"./index-CQ75r9EK.js";import{L}from"./label-D8wDE7WX.js";import{T as Me}from"./text-shimmer-BJUA6AoE.js";import{q as R,R as Be,a as Fe}from"./question-type-JApPeNfu.js";import{X as Ue}from"./x-D7PiG2td.js";import{P as $e}from"./plus-CXSvhfCS.js";import{C as He,a as Qe}from"./chevron-right-CMQnITYC.js";import{u as Ge}from"./proxy-DpqCZSDj.js";import{T as Xe}from"./trash-2-aMbAjlot.js";import"./Combination-BQk3dayN.js";import"./chevron-down-jKp8XsSb.js";import"./file-text-BXbKjMWl.js";import"./clock-D9d1ag9F.js";import"./calendar-BU_PnCKU.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],We=ye("grip-vertical",Je);var Ye=Object.defineProperty,Ke=(e,s,r)=>s in e?Ye(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,h=(e,s,r)=>Ke(e,typeof s!="symbol"?s+"":s,r);class y{constructor({isOptional:s}){h(this,"type"),h(this,"fieldPaths"),h(this,"isOptional"),h(this,"isConvexValidator"),this.isOptional=s,this.isConvexValidator=!0}get optional(){return this.isOptional==="optional"}}class X extends y{constructor({isOptional:s,tableName:r}){super({isOptional:s}),h(this,"tableName"),h(this,"kind","id"),this.tableName=r}get json(){return{type:"id",tableName:this.tableName}}asOptional(){return new X({isOptional:"optional",tableName:this.tableName})}}class D extends y{constructor(){super(...arguments),h(this,"kind","float64")}get json(){return{type:"number"}}asOptional(){return new D({isOptional:"optional"})}}class M extends y{constructor(){super(...arguments),h(this,"kind","int64")}get json(){return{type:"bigint"}}asOptional(){return new M({isOptional:"optional"})}}class J extends y{constructor(){super(...arguments),h(this,"kind","boolean")}get json(){return{type:this.kind}}asOptional(){return new J({isOptional:"optional"})}}class W extends y{constructor(){super(...arguments),h(this,"kind","bytes")}get json(){return{type:this.kind}}asOptional(){return new W({isOptional:"optional"})}}class Y extends y{constructor(){super(...arguments),h(this,"kind","string")}get json(){return{type:this.kind}}asOptional(){return new Y({isOptional:"optional"})}}class K extends y{constructor(){super(...arguments),h(this,"kind","null")}get json(){return{type:this.kind}}asOptional(){return new K({isOptional:"optional"})}}class Z extends y{constructor(){super(...arguments),h(this,"kind","any")}get json(){return{type:this.kind}}asOptional(){return new Z({isOptional:"optional"})}}class ee extends y{constructor({isOptional:s,fields:r}){super({isOptional:s}),h(this,"fields"),h(this,"kind","object"),this.fields=r}get json(){return{type:this.kind,value:globalThis.Object.fromEntries(globalThis.Object.entries(this.fields).map(([s,r])=>[s,{fieldType:r.json,optional:r.isOptional==="optional"}]))}}asOptional(){return new ee({isOptional:"optional",fields:this.fields})}}class te extends y{constructor({isOptional:s,value:r}){super({isOptional:s}),h(this,"value"),h(this,"kind","literal"),this.value=r}get json(){return{type:this.kind,value:Ce(this.value)}}asOptional(){return new te({isOptional:"optional",value:this.value})}}class se extends y{constructor({isOptional:s,element:r}){super({isOptional:s}),h(this,"element"),h(this,"kind","array"),this.element=r}get json(){return{type:this.kind,value:this.element.json}}asOptional(){return new se({isOptional:"optional",element:this.element})}}class re extends y{constructor({isOptional:s,key:r,value:u}){if(super({isOptional:s}),h(this,"key"),h(this,"value"),h(this,"kind","record"),r.isOptional==="optional")throw new Error("Record validator cannot have optional keys");if(u.isOptional==="optional")throw new Error("Record validator cannot have optional values");this.key=r,this.value=u}get json(){return{type:this.kind,keys:this.key.json,values:{fieldType:this.value.json,optional:!1}}}asOptional(){return new re({isOptional:"optional",key:this.key,value:this.value})}}class ne extends y{constructor({isOptional:s,members:r}){super({isOptional:s}),h(this,"members"),h(this,"kind","union"),this.members=r}get json(){return{type:this.kind,value:this.members.map(s=>s.json)}}asOptional(){return new ne({isOptional:"optional",members:this.members})}}function Ze(e){return!!e.isConvexValidator}const n={id:e=>new X({isOptional:"required",tableName:e}),null:()=>new K({isOptional:"required"}),number:()=>new D({isOptional:"required"}),float64:()=>new D({isOptional:"required"}),bigint:()=>new M({isOptional:"required"}),int64:()=>new M({isOptional:"required"}),boolean:()=>new J({isOptional:"required"}),string:()=>new Y({isOptional:"required"}),bytes:()=>new W({isOptional:"required"}),literal:e=>new te({isOptional:"required",value:e}),array:e=>new se({isOptional:"required",element:e}),object:e=>new ee({isOptional:"required",fields:e}),record:(e,s)=>new re({isOptional:"required",key:e,value:s}),union:(...e)=>new ne({isOptional:"required",members:e}),any:()=>new Z({isOptional:"required"}),optional:e=>e.asOptional()};var et=Object.defineProperty,tt=(e,s,r)=>s in e?et(e,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[s]=r,P=(e,s,r)=>tt(e,typeof s!="symbol"?s+"":s,r);class le{constructor(s){P(this,"indexes"),P(this,"searchIndexes"),P(this,"vectorIndexes"),P(this,"validator"),this.indexes=[],this.searchIndexes=[],this.vectorIndexes=[],this.validator=s}index(s,r){return this.indexes.push({indexDescriptor:s,fields:r}),this}searchIndex(s,r){return this.searchIndexes.push({indexDescriptor:s,searchField:r.searchField,filterFields:r.filterFields||[]}),this}vectorIndex(s,r){return this.vectorIndexes.push({indexDescriptor:s,vectorField:r.vectorField,dimensions:r.dimensions,filterFields:r.filterFields||[]}),this}self(){return this}export(){return{indexes:this.indexes,searchIndexes:this.searchIndexes,vectorIndexes:this.vectorIndexes,documentType:this.validator.json}}}function G(e){return Ze(e)?new le(e):new le(n.object(e))}class st{constructor(s,r){P(this,"tables"),P(this,"strictTableNameTypes"),P(this,"schemaValidation"),this.tables=s,this.schemaValidation=(r==null?void 0:r.schemaValidation)===void 0?!0:r.schemaValidation}export(){return JSON.stringify({tables:Object.entries(this.tables).map(([s,r])=>{const{indexes:u,searchIndexes:m,vectorIndexes:a,documentType:l}=r.export();return{tableName:s,indexes:u,searchIndexes:m,vectorIndexes:a,documentType:l}}),schemaValidation:this.schemaValidation})}}function rt(e,s){return new st(e,s)}rt({_scheduled_functions:G({name:n.string(),args:n.array(n.any()),scheduledTime:n.float64(),completedTime:n.optional(n.float64()),state:n.union(n.object({kind:n.literal("pending")}),n.object({kind:n.literal("inProgress")}),n.object({kind:n.literal("success")}),n.object({kind:n.literal("failed"),error:n.string()}),n.object({kind:n.literal("canceled")}))}),_storage:G({sha256:n.string(),size:n.float64(),contentType:n.optional(n.string())})});class nt{constructor(){this.componentControls=new Set}subscribe(s){return this.componentControls.add(s),()=>this.componentControls.delete(s)}start(s,r){this.componentControls.forEach(u=>{u.start(s.nativeEvent||s,r)})}}const it=()=>new nt;function ot(){return Ge(it)}function at(e){const s=C.useRef({value:e,previous:e});return C.useMemo(()=>(s.current.value!==e&&(s.current.previous=s.current.value,s.current.value=e),s.current.previous),[e])}var B="Switch",[lt,Ft]=Ve(B),[ct,dt]=lt(B),fe=C.forwardRef((e,s)=>{const{__scopeSwitch:r,name:u,checked:m,defaultChecked:a,required:l,disabled:p,value:o="on",onCheckedChange:I,form:j,...S}=e,[O,c]=C.useState(null),g=de(s,x=>c(x)),k=C.useRef(!1),d=O?j||!!O.closest("form"):!0,[b,z]=Re({prop:m,defaultProp:a??!1,onChange:I,caller:B});return t.jsxs(ct,{scope:r,checked:b,disabled:p,children:[t.jsx(xe.button,{type:"button",role:"switch","aria-checked":b,"aria-required":l,"data-state":je(b),"data-disabled":p?"":void 0,disabled:p,value:o,...S,ref:g,onClick:Le(e.onClick,x=>{z(A=>!A),d&&(k.current=x.isPropagationStopped(),k.current||x.stopPropagation())})}),d&&t.jsx(we,{control:O,bubbles:!k.current,name:u,value:o,checked:b,required:l,disabled:p,form:j,style:{transform:"translateX(-100%)"}})]})});fe.displayName=B;var ge="SwitchThumb",be=C.forwardRef((e,s)=>{const{__scopeSwitch:r,...u}=e,m=dt(ge,r);return t.jsx(xe.span,{"data-state":je(m.checked),"data-disabled":m.disabled?"":void 0,...u,ref:s})});be.displayName=ge;var ut="SwitchBubbleInput",we=C.forwardRef(({__scopeSwitch:e,control:s,checked:r,bubbles:u=!0,...m},a)=>{const l=C.useRef(null),p=de(l,a),o=at(r),I=De(s);return C.useEffect(()=>{const j=l.current;if(!j)return;const S=window.HTMLInputElement.prototype,c=Object.getOwnPropertyDescriptor(S,"checked").set;if(o!==r&&c){const g=new Event("click",{bubbles:u});c.call(j,r),j.dispatchEvent(g)}},[o,r,u]),t.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...m,tabIndex:-1,ref:p,style:{...m.style,...I,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});we.displayName=ut;function je(e){return e?"checked":"unchecked"}var pt=fe,ht=be;function mt({className:e,...s}){return t.jsx(pt,{"data-slot":"switch",className:q("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 inline-flex h-5 w-9 shrink-0 items-center rounded-full border-2 border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...s,children:t.jsx(ht,{"data-slot":"switch-thumb",className:q("bg-background pointer-events-none block size-4 rounded-full ring-0 shadow-lg transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})})}let V=(e=21)=>crypto.getRandomValues(new Uint8Array(e)).reduce((s,r)=>(r&=63,r<36?s+=r.toString(36):r<62?s+=(r-26).toString(36).toUpperCase():r>62?s+="-":s+="_",s),"");const xt=G({question:n.string(),referenceId:n.string(),originalReferenceId:n.optional(n.string()),organizationId:n.id("organization"),order:n.number(),type:n.union(n.literal("multiple-choice"),n.literal("yes-or-no"),n.literal("text-field"),n.literal("file-upload"),n.literal("fill-the-blank"),n.literal("audio-response"),n.literal("video-response"),n.literal("dropdown"),n.literal("matching-pairs"),n.literal("slider-scale")),pointValue:n.optional(n.number()),options:n.optional(n.array(n.object({id:n.string(),text:n.string(),isCorrect:n.boolean(),mediaUrl:n.optional(n.string()),mediaType:n.optional(n.string()),pointValue:n.optional(n.number())}))),allowMultipleAnswers:n.boolean(),deletedAt:n.optional(n.number())}).index("by_reference_id",["referenceId"]),ft=({value:e,onValueChange:s,variant:r="outline",className:u,readonly:m=!1})=>{const a=e&&R[e]?R[e]:R["multiple-choice"],l=(a==null?void 0:a.icon)||(()=>null);return t.jsxs(Se,{children:[t.jsx(qe,{asChild:!0,children:t.jsxs(w,{disabled:m,variant:r,className:q("cursor-default disabled:opacity-100",u),children:[l&&t.jsx(l,{size:16,className:"mr-1"}),a==null?void 0:a.label]})}),t.jsxs(Pe,{align:"start",className:"w-[240px] p-2",children:[t.jsx(L,{className:"px-2 mb-2 block",children:"Question Type"}),t.jsx("div",{className:"flex flex-col gap-1",children:Object.values(R).map(p=>{const o=p.icon||(()=>null);return p.isHidden?null:t.jsxs(w,{onClick:I=>{I.stopPropagation(),s==null||s(p.value)},size:"sm",className:"w-full justify-start gap-2",variant:e===p.value?"default":"ghost",children:[o&&t.jsx(o,{size:16}),p.label]},p.value)})})]})]})},gt=e=>{switch(e){case"multiple-choice":return Array.from({length:4},(s,r)=>({id:V(5),text:"",isCorrect:r===0}));case"yes-or-no":return[{id:V(5),text:"Yes",isCorrect:!0},{id:V(5),text:"No",isCorrect:!1}];default:return[]}};Te.extend(Ie);const Q=3e3,ce=10,Ut=()=>{const e=ue(),{questionId:s,selectedSectionId:r,testId:u,bankId:m}=pe({from:"/(organizer)/app/questions/details"}),[a,l]=C.useState(0),p=Oe(E.organizer.question.update).withOptimisticUpdate((i,f)=>{const N=i.getQuery(E.organizer.question.getById,{id:f.id});N&&i.setQuery(E.organizer.question.getById,{id:f.id},{...N,...f.data})}),o=he(E.organizer.question.getById,{id:s}),I=o===void 0,{control:j,handleSubmit:S,reset:O,watch:c,setValue:g,clearErrors:k,formState:{isDirty:d,errors:b}}=Ae({reValidateMode:"onChange"}),{allowMultipleAnswers:z,options:x}=c(),A=(o==null?void 0:o.type)==="multiple-choice"||(o==null?void 0:o.type)==="yes-or-no",ve=()=>{if(!A||!x)return!0;if(x.length<2)return"At least 2 options are required";const i=x.filter(T=>T.isCorrect);if(i.length===0)return"At least one option must be marked as correct";if(z&&i.length===x.length)return"Not all options can be marked as correct in multiple-choice questions";if(x.filter(T=>!T.text||T.text.trim()==="").length>0)return"All options must have text content";const N=x.map(T=>{var v;return(v=T.text)==null?void 0:v.trim().toLowerCase()});return new Set(N.filter(T=>T)).size<N.filter(T=>T).length?"All options must have unique values":!0};C.useEffect(()=>{o&&O(o)},[o,O]);const ie=async i=>{if(o!=null&&o._id){if(A&&i.options){if(i.options.length<2){alert("At least 2 options are required");return}const f=i.options.filter(v=>v.isCorrect);if(f.length===0){alert("At least one option must be marked as correct");return}if(i.allowMultipleAnswers&&f.length===i.options.length){alert("Not all options can be marked as correct in multiple-choice questions");return}if(i.options.filter(v=>!v.text||v.text.trim()==="").length>0){alert("All options must have text content");return}const F=i.options.map(v=>{var ae;return(ae=v.text)==null?void 0:ae.trim().toLowerCase()});if(new Set(F.filter(v=>v)).size<F.filter(v=>v).length){alert("All options must have unique values");return}}await p({id:o._id,data:{question:i.question,options:i.options}})}},oe=()=>{u?e({to:"/app/tests/details",search:{tabs:"questions",testId:u,selectedSection:r,resultsTab:"summary"}}):m?e({to:"/app/questions/library",search:{bankId:m}}):window.history.length>1&&document.referrer?window.history.back():e({to:"/app/questions"})};return t.jsxs("div",{children:[t.jsxs("div",{className:"flex flex-row w-full justify-between items-center",children:[t.jsxs("div",{className:"flex flex-row gap-3 items-center",children:[t.jsx(w,{variant:"secondary",size:"icon-sm",onClick:oe,children:t.jsx(ke,{})}),t.jsxs("h1",{className:"",children:["Question ",o==null?void 0:o.order]})]}),t.jsxs("div",{className:"flex flex-row gap-3",children:[d&&t.jsx(w,{disabled:!d,variant:"outline",onClick:()=>{O()},children:"Reset"}),d&&(u&&r||m)?t.jsx(w,{disabled:!d,variant:d?"outline-solid":"secondary",onClick:S(i=>{ie(i).then(()=>{oe()})}),children:"Save & Back"}):null,t.jsx(w,{disabled:!d,variant:d?"default":"secondary",onClick:S(i=>{ie(i)}),children:"Save"})]})]}),t.jsxs("div",{className:"flex flex-row gap-2 justify-between items-center mt-8",children:[t.jsxs("div",{className:"flex flex-row gap-2 items-center mb-3",children:[t.jsx(_,{control:j,name:"type",render:({field:i})=>t.jsx(ft,{value:i.value||void 0,onValueChange:f=>{i.onChange(f);const N=gt(f);N&&(g("options",N),g("allowMultipleAnswers",!1),k())}})}),t.jsx(_,{control:j,name:"pointValue",rules:{validate:i=>typeof i=="number"&&(i==0||i>100)?"Point value must be between 0 and 100":!0},render:({field:i})=>typeof i.value=="number"?t.jsxs("div",{className:"flex flex-row gap-2 items-center relative",children:[t.jsx(L,{className:"absolute left-2.5 text-xs text-muted-foreground/80 pt-0.5",children:"Point Value"}),t.jsx(me,{type:"number",className:q("w-28 pl-12 h-7",b.pointValue?"border-destructive":""),min:0,max:100,placeholder:"0",value:i.value===0&&!i.value?"":i.value,onChange:f=>{const N=f.target.value===""?0:Number(f.target.value);i.onChange(N)}}),t.jsx(w,{variant:"ghost",size:"icon-xs",className:"absolute right-1",onClick:()=>{g("pointValue",void 0,{shouldDirty:!0})},children:t.jsx(Ue,{className:"size-3"})})]}):t.jsxs(w,{onClick:()=>{i.onChange(5)},variant:"secondary",className:"hidden",children:[t.jsx($e,{}),"Add Point"]})}),b.pointValue&&t.jsx("span",{className:"text-xs text-destructive",children:b.pointValue.message})]}),o?t.jsx(jt,{referenceId:o==null?void 0:o.referenceId}):t.jsx(Me,{children:"Loading..."})]}),t.jsxs("div",{className:"pb-4",children:[t.jsx(_,{control:j,name:"question",rules:{validate:()=>a<ce?`Question text must be at least ${ce} characters`:a>Q?`Question text must be less than ${Q} characters`:!0},render:({field:i})=>{var f;return t.jsxs("div",{className:"relative",children:[t.jsx(ze,{disabled:o===void 0,onContentLengthChange:l,value:i.value||"",onChange:i.onChange,placeholder:"Type your question here...",editorClassName:q(b.question?"border-destructive":""),toolbarClassName:q("sticky top-0",b.question?"border-destructive":"")}),t.jsxs("p",{className:"absolute bottom-3 right-3 text-xs text-muted-foreground",children:[a," / ",Q]}),t.jsx("span",{className:q("text-xs text-muted-foreground mt-2",b.question?"text-destructive":""),children:b.question?t.jsx("span",{className:"ml-2",children:(f=b.question)==null?void 0:f.message}):null})]})}}),A&&!I?t.jsxs("div",{className:"mt-8 mb-6 flex flex-row items-center gap-2",children:[t.jsx(L,{className:"text-sm text-muted-foreground",children:"Select Correct Answer"}),t.jsx(_e,{className:"flex-1"}),x&&(x==null?void 0:x.length)>2?t.jsxs("div",{className:"flex flex-row items-center gap-2",children:[t.jsx(L,{className:"text-sm text-muted-foreground",children:"Allow Multiple Answers"}),t.jsx(mt,{checked:z===!0,onCheckedChange:i=>{i===!1&&((x==null?void 0:x.filter(f=>f.isCorrect).length)||0)>1&&g("options",x==null?void 0:x.map(f=>({...f,isCorrect:!1})),{shouldDirty:!0}),g("allowMultipleAnswers",i)}})]}):null]}):null,A&&x?t.jsx(_,{control:j,name:"options",rules:{validate:ve},render:({field:i})=>t.jsxs(t.Fragment,{children:[t.jsx(bt,{value:i.value||[],onChange:f=>{i.onChange(f)},type:o==null?void 0:o.type,allowMultipleAnswers:z===!0}),b.options&&t.jsx("span",{className:"text-xs text-destructive mt-2",children:b.options.message})]})}):null]})]})},bt=({value:e,onChange:s,allowMultipleAnswers:r,type:u})=>{var O;const m=c=>{e&&s(e.map(g=>g.id===c.id?c:g))},a=((O=e==null?void 0:e.filter(c=>c.isCorrect))==null?void 0:O.length)||0,l=a===0,p=e&&e.length>0&&a===e.length,o=e==null?void 0:e.some(c=>!c.text||c.text.trim()===""),I=e&&e.length<2,j=(()=>{if(!e)return!1;const c=e.map(k=>{var d;return(d=k.text)==null?void 0:d.trim().toLowerCase()}).filter(k=>k);return new Set(c).size<c.length})(),S=u==="multiple-choice"?5:u==="yes-or-no"?2:0;return e?t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsx(Be,{className:"flex flex-col gap-2 mt-2 text-sm",onReorder:c=>{s(c)},values:e,children:e.map((c,g)=>{const k=!!(c.text&&c.text.trim()!==""&&e.some(d=>d.id!==c.id&&d.text&&d.text.trim().toLowerCase()===c.text.trim().toLowerCase()));return t.jsx(wt,{option:c,index:g,onChange:d=>{m(d)},onClickCorrect:()=>{s(r?e.map(d=>d.id===c.id?{...d,isCorrect:!d.isCorrect}:d):e.map(d=>({...d,isCorrect:d.id===c.id?!c.isCorrect:!1})))},onDelete:()=>{s(e.filter(d=>d.id!==c.id))},isDuplicate:k},c.id)})}),e&&e.length<S&&t.jsx("div",{className:"mt-4 mx-auto",children:t.jsx(w,{variant:"outline",className:"w-max border-dashed",onClick:()=>{if(e.length<S){const c={id:V(5),text:"",isCorrect:!1};s([...e,c])}},children:"Add Option"})}),l&&t.jsx("div",{className:"text-sm text-warning-foreground bg-warning p-2 rounded-md mb-2",children:"At least one option must be marked as correct"}),r&&p&&t.jsx("div",{className:"text-sm text-warning-foreground bg-warning p-2 rounded-md mb-2",children:"Not all options should be marked as correct in multiple-choice questions"}),o&&t.jsx("div",{className:"text-sm text-warning-foreground bg-warning p-2 rounded-md mb-2",children:"All options must have text content"}),I&&t.jsx("div",{className:"text-sm text-warning-foreground bg-warning p-2 rounded-md mb-2",children:"At least two options are required"}),j&&t.jsx("div",{className:"text-sm text-warning-foreground bg-warning p-2 rounded-md mb-2",children:"All options must have unique values"})]}):null},wt=({option:e,index:s,onChange:r,onClickCorrect:u,onDelete:m,isDuplicate:a})=>{const l=ot(),p=!e.text||e.text.trim()==="";return t.jsxs(Fe,{value:e,className:"flex flex-row items-center gap-1",dragListener:!1,dragControls:l,children:[t.jsxs(U,{children:[t.jsx($,{asChild:!0,children:t.jsx(w,{size:"icon",className:"select-none mr-2",variant:e.isCorrect?"success":"secondary",onClick:u,children:e.isCorrect?t.jsx(Ee,{className:"size-5"}):String.fromCharCode(65+s)})}),t.jsx(H,{children:e.isCorrect?"This is the correct answer":"Click to mark as correct answer"})]}),t.jsx("div",{className:"flex-1 flex flex-row items-center",children:t.jsx(me,{placeholder:`Option ${s+1}`,className:q("bg-card h-9",p?"border-destructive":"",a?"border-amber-500 bg-warning":""),value:e.text,onChange:o=>{r({...e,text:o.target.value})}})}),t.jsxs("div",{children:[t.jsxs(U,{children:[t.jsx($,{asChild:!0,children:t.jsx(w,{onPointerDown:o=>l.start(o),variant:"ghost",size:"icon",children:t.jsx(We,{className:"text-muted-foreground"})})}),t.jsx(H,{children:"Drag to reorder options"})]}),t.jsxs(U,{children:[t.jsx($,{asChild:!0,children:t.jsx(w,{variant:"ghost",size:"icon",onClick:m,children:t.jsx(Xe,{className:"text-muted-foreground"})})}),t.jsx(H,{children:"Delete option"})]})]})]})},jt=({referenceId:e})=>{const{questionId:s,selectedSectionId:r,testId:u}=pe({from:"/(organizer)/app/questions/details"}),m=ue(),a=he(E.organizer.question.getAllByReferenceId,{referenceId:e}),l=C.useMemo(()=>a==null?void 0:a.find(p=>p._id===s),[a,s]);return t.jsxs("div",{className:"flex flex-row items-center gap-2",children:[t.jsx(w,{variant:"outline",size:"icon",disabled:(l==null?void 0:l.order)===1,onClick:()=>{if(!l)return;const p=a==null?void 0:a[(l==null?void 0:l.order)-2];p&&m({to:"/app/questions/details",search:{questionId:p._id,selectedSectionId:r,testId:u}})},children:t.jsx(He,{})}),xt&&l?t.jsxs("div",{className:"gap-0.5 flex flex-row items-center text-base select-none",children:[l==null?void 0:l.order,t.jsx("span",{className:"text-sm",children:"/"}),a==null?void 0:a.length]}):t.jsx(Ne,{className:"size-4 animate-spin"}),t.jsx(w,{variant:"outline",size:"icon",disabled:(l==null?void 0:l.order)===(a==null?void 0:a.length),onClick:()=>{if(!l)return;const p=a==null?void 0:a[l==null?void 0:l.order];p&&m({to:"/app/questions/details",search:{questionId:p._id,selectedSectionId:r,testId:u}})},children:t.jsx(Qe,{})})]})};export{Ut as default};
