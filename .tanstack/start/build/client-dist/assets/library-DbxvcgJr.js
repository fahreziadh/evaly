import{i as R,a5 as M,h as q,g as n,f as h,r as c,j as e,c as H,B as a,V as C,C as p,P as U,Q as V,e as w,o as T,T as O}from"./main-Cf9OxwIv.js";import{B as Q}from"./badge-oBenMcsD.js";import{I as Y}from"./input-CmcoE0j1.js";import{T as G}from"./textarea-COU2Zv26.js";import{L as g}from"./label-D8wDE7WX.js";import{S as L}from"./separator-CaSlYSmw.js";import{S as J}from"./settings-DFi-jblr.js";import{P as j}from"./plus-CXSvhfCS.js";import{T as K}from"./trash-2-aMbAjlot.js";import"./index-CQ75r9EK.js";T.extend(O);function ne(){const o=R(),{bankId:r}=M.useSearch(),t=q(n.organizer.questionLibrary.getById,{id:r}),l=q(n.organizer.questionLibrary.getQuestions,{questionLibraryId:r}),k=h(n.organizer.questionLibrary.addQuestion),S=h(n.organizer.question.deleteById),[F,u]=c.useState(!1),[f,m]=c.useState(""),[y,x]=c.useState(""),[I,N]=c.useState(null),E=h(n.organizer.questionLibrary.update),z=async()=>{if(t)try{await E({id:t._id,title:f,description:y}),u(!1)}catch(s){console.error("Failed to update question library:",s),alert("Failed to update question library. Please try again.")}},B=()=>{t&&(m(t.title),x(t.description||"")),u(!1)},b=async s=>{try{const i=await k({questionLibraryId:r,type:s});o({to:"/app/questions/details",search:{questionId:i,bankId:r}})}catch(i){console.error("Failed to add question:",i),alert("Failed to add question. Please try again.")}},P=async s=>{if(confirm("Are you sure you want to delete this question?"))try{N(s),await S({id:s})}catch(i){console.error("Failed to delete question:",i),alert("Failed to delete question. Please try again.")}finally{N(null)}},A=s=>{switch(s){case"multiple-choice":return"Multiple Choice";case"yes-or-no":return"Yes/No";case"text-field":return"Text Field";case"file-upload":return"File Upload";case"fill-the-blank":return"Fill the Blank";case"audio-response":return"Audio Response";case"video-response":return"Video Response";case"dropdown":return"Dropdown";case"matching-pairs":return"Matching Pairs";case"slider-scale":return"Slider Scale";default:return s}},D=s=>{const i=document.createElement("div");return i.innerHTML=s,i.textContent||i.innerText||""};return t===void 0||l===void 0?e.jsx(H,{}):t?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-row items-center gap-3 mb-6",children:[e.jsx(a,{variant:"secondary",size:"icon-sm",onClick:()=>o({to:"/app/questions"}),children:e.jsx(C,{})}),e.jsx("div",{className:"flex-1",children:F?e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{value:f,onChange:s=>m(s.target.value),placeholder:"Question library title",className:"text-xl font-bold"}),e.jsx(G,{value:y,onChange:s=>x(s.target.value),placeholder:"Optional description",rows:2}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(a,{size:"sm",onClick:z,children:"Save"}),e.jsx(a,{size:"sm",variant:"outline",onClick:B,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"dashboard-title",children:t.title}),t.description&&e.jsx("p",{className:"dashboard-description",children:t.description})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{variant:"outline",onClick:()=>{m(t.title),x(t.description||""),u(!0)},children:[e.jsx(J,{className:"mr-2 h-4 w-4"}),"Edit Library"]}),e.jsxs(a,{onClick:()=>b("multiple-choice"),children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Add Question"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsxs(p,{className:"lg:col-span-1 lg:self-start lg:sticky lg:top-4 shadow-sm border-border/50",children:[e.jsx(U,{children:e.jsx(V,{className:"text-base",children:"Library Information"})}),e.jsxs(w,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Questions"}),e.jsx("p",{className:"text-2xl font-bold",children:l.length})]}),e.jsx(L,{}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Created"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:T(t._creationTime).fromNow()})]}),t.tags&&t.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium",children:"Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:t.tags.map((s,i)=>e.jsx(Q,{variant:"outline",className:"text-xs",children:s},i))})]})]})]})]}),e.jsx("div",{className:"lg:col-span-3 space-y-3",children:l.length===0?e.jsxs(p,{className:"p-8 text-center",children:[e.jsx(j,{className:"mx-auto h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No questions yet"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Start building your question library by adding your first question."}),e.jsxs(a,{onClick:()=>b("multiple-choice"),children:[e.jsx(j,{className:"mr-2 h-4 w-4"}),"Add First Question"]})]}):l.map((s,i)=>{const d=D(s.question),_=d.length>120?d.substring(0,120)+"...":d||"No question text";return e.jsx(p,{className:"group hover:border-primary/30",children:e.jsx(w,{className:"p-4",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>o({to:"/app/questions/details",search:{questionId:s._id,bankId:r}}),children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-muted-foreground",children:["Q",i+1]}),e.jsx(Q,{variant:"secondary",className:"text-xs",children:A(s.type)})]}),e.jsx("h3",{className:"font-medium mb-2",children:d||"Untitled Question"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:_})]}),e.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity ml-2",children:e.jsx(a,{variant:"ghost",size:"icon-sm",onClick:v=>{v.preventDefault(),v.stopPropagation(),P(s._id)},disabled:I===s._id,children:e.jsx(K,{className:"h-4 w-4 text-destructive"})})})]})})},s._id)})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Question Library Not Found"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"The question library you're looking for doesn't exist or you don't have access to it."}),e.jsxs(a,{onClick:()=>o({to:"/app/questions"}),children:[e.jsx(C,{className:"mr-2 h-4 w-4"}),"Back to Question Libraries"]})]})}export{ne as component};
