import{j as a,r as o,h as D,g as f,f as p,W as v}from"./main-DlyImwyW.js";import{L as w,A as b,a as N,b as P}from"./logo-cIRsNJyn.js";import{D as A,a as y,b as E,d as M,e as C,c as h}from"./dropdown-menu-sOts507K.js";import{D as F,b as L,c as S,d as k}from"./dialog-BkomBEYl.js";const R=({open:e,onClose:t})=>a.jsx(F,{open:e,onOpenChange:t,children:a.jsx(L,{children:a.jsx(S,{children:a.jsx(k,{children:"Update Profile"})})})});function g(e){const t=o.useRef({inFlight:!1,upNext:null});return o.useCallback((...s)=>{if(t.current.inFlight)return new Promise((n,c)=>{t.current.upNext={fn:e,resolve:n,reject:c,args:s}});t.current.inFlight=!0;const r=e(...s);return(async()=>{try{await r}finally{}for(;t.current.upNext;){let n=t.current.upNext;t.current.upNext=null,await n.fn(...n.args).then(n.resolve).catch(n.reject)}t.current.inFlight=!1})(),r},[e])}const T=4e3,O=(e,t,s,r=T)=>{const[n,c]=o.useState(s);let l=D(f.participant.testPresence.list,{testId:e});l&&(l=l.filter(i=>i.participantId!==t));const u=g(p(f.participant.testPresence.update)),d=g(p(f.participant.testPresence.heartbeat));o.useEffect(()=>{u({testId:e,participantId:t,data:n}),d({testId:e,participantId:t})},[]),o.useEffect(()=>{const i=setInterval(()=>{d({testId:e,participantId:t})},r);return()=>clearInterval(i)},[d,e,t,r]);const j=o.useCallback(i=>{c(m=>{const x={...m,...i};return u({testId:e,participantId:t,data:x}),x})},[e,t,u]);return{data:n,presence:l,updateData:j}},Q=({user:e})=>{const{testId:t}=v({from:"/(participant)/s/$testId/"}),{updateData:s}=O(t,e._id,{});return o.useEffect(()=>{s({data:{testId:t,testSectionId:void 0}})},[t]),a.jsxs("div",{className:"flex flex-row justify-between h-14 px-4 fixed top-0 w-full",children:[a.jsx("div",{className:"flex flex-row items-center gap-2",children:a.jsx(w,{href:"/"})}),a.jsx("div",{className:"flex flex-row items-center gap-2",children:a.jsx(U,{user:e})})]})},U=({user:e})=>{var r;const[t,s]=o.useState(!1);return a.jsxs(A,{children:[a.jsx(y,{className:" hover:opacity-75 transition",children:a.jsxs(b,{children:[a.jsx(N,{src:e==null?void 0:e.image}),a.jsx(P,{children:(r=e==null?void 0:e.name)==null?void 0:r.charAt(0)})]})}),a.jsxs(E,{side:"bottom",align:"end",className:"w-56",children:[a.jsx(M,{children:"My Account"}),a.jsx(C,{}),a.jsx(h,{onClick:()=>s(!0),children:"Update Profile"}),a.jsx(h,{children:"Logout"})]}),a.jsx(R,{open:t,onClose:()=>s(!1)})]})};export{U as A,Q as N,O as u};
