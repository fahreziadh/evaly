import {pgTable,timestamp,varchar,index,foreignKey}from'drizzle-orm/pg-core';import {user}from'./user';import {sql,relations}from'drizzle-orm';import {ulid}from'ulidx';const r=pgTable("organization",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"orgs-"+ulid()),name:varchar("name",{length:255}).notNull(),logoUrl:varchar("logo_url",{length:255}),type:varchar("type",{length:50,enum:["school","company","other"]}).default("other"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString()),deletedAt:timestamp("deleted_at",{mode:"string",withTimezone:true})},e=>({organizationId:index("organization_id_idx").on(e.id)})),i=pgTable("organizer",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"org-"+ulid()),userId:varchar("user_id",{length:255}).notNull(),organizationId:varchar("organization_id",{length:255}).notNull(),level:varchar("level",{length:10,enum:["owner","admin"]}).notNull(),organizationRole:varchar("organizationRole",{length:100,enum:["teacher","hr","admin","other"]}).default("other"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString()),deletedAt:timestamp("deleted_at",{mode:"string",withTimezone:true})},e=>({organizerIdIdx:index("organizer_id_idx").on(e.id),userFk:foreignKey({columns:[e.userId],foreignColumns:[user.id],name:"organizer_user_fk"}).onDelete("cascade"),organizationFk:foreignKey({columns:[e.organizationId],foreignColumns:[r.id],name:"organizer_organization_fk"}).onDelete("cascade")})),h=relations(r,({many:e})=>({organizers:e(i)})),c=relations(i,({one:e})=>({user:e(user,{fields:[i.userId],references:[user.id]}),organization:e(r,{fields:[i.organizationId],references:[r.id]})}));export{r as organization,h as organizationRelations,i as organizer,c as organizerRelations};//# sourceMappingURL=organization.js.map
//# sourceMappingURL=organization.js.map