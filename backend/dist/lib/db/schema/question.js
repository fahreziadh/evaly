import {sql,relations}from'drizzle-orm';import {pgTable,timestamp,boolean,jsonb,smallint,varchar,text,index,integer,unique}from'drizzle-orm/pg-core';import {ulid}from'ulidx';import {testSession}from'./test.session';import {QUESTION_TYPES}from'../../../types/question-types';import {MEDIA_TYPES}from'../../../types/media';const t=pgTable("question",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"qst-"+ulid()),question:text("question"),referenceId:varchar("reference_id",{length:255}).notNull(),referenceType:varchar("reference_type",{length:100,enum:["test-session","template","ai-generated"]}).notNull().default("test-session"),organizationId:varchar("organization_id",{length:255}),order:smallint("order").default(1).notNull(),type:varchar("type",{length:20,enum:QUESTION_TYPES}).default("multiple-choice"),pointValue:smallint("point_value"),options:jsonb("options").$type().default([]),allowMultipleAnswers:boolean("allow_multiple_answers").default(false).notNull(),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString()),deletedAt:timestamp("deleted_at",{mode:"string",withTimezone:true})},e=>({referenceIdIndex:index("reference_idx").on(e.referenceId)})),_=pgTable("text_field_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"txt-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),modelAnswer:text("model_answer"),minLength:integer("min_length"),maxLength:integer("max_length"),placeholder:text("placeholder"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("textfield_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),p=pgTable("fill_blank_segment",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"blk-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),segmentOrder:integer("segment_order").notNull(),segmentText:text("segment_text"),isBlank:boolean("is_blank").notNull(),expectedAnswer:text("expected_answer"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("blank_question_idx").on(e.questionId),orderIndex:index("blank_order_idx").on(e.questionId,e.segmentOrder)})),T=pgTable("media_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"med-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),mediaType:varchar("media_type",{length:10,enum:MEDIA_TYPES}).notNull(),maxFileSizeMb:integer("max_file_size_mb"),sampleResponseUrl:text("sample_response_url"),instructions:text("instructions"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("media_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),q=pgTable("slider_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"sld-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),minValue:integer("min_value").notNull(),maxValue:integer("max_value").notNull(),step:integer("step").default(1),defaultValue:integer("default_value"),minLabel:text("min_label"),maxLabel:text("max_label"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("slider_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),I=pgTable("matching_pair",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"mpr-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),leftItem:text("left_item").notNull(),rightItem:text("right_item").notNull(),order:smallint("order"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("matching_question_idx").on(e.questionId)})),N=pgTable("matrix_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"mtx-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),rows:text("rows").array().notNull(),columns:text("columns").array().notNull(),matrixType:varchar("matrix_type",{length:20}).notNull(),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("matrix_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),h=pgTable("hotspot_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"hsp-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),imageUrl:text("image_url").notNull(),hotspots:jsonb("hotspots").notNull(),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("hotspot_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),x=pgTable("code_editor_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"code-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),language:varchar("language",{length:50}).notNull(),initialCode:text("initial_code"),solutionCode:text("solution_code"),testCases:jsonb("test_cases"),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("code_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),C=pgTable("date_time_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"dt-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),minDate:timestamp("min_date",{mode:"string",withTimezone:true}),maxDate:timestamp("max_date",{mode:"string",withTimezone:true}),correctDate:timestamp("correct_date",{mode:"string",withTimezone:true}),format:varchar("format",{length:50}),allowTimeSelection:boolean("allow_time_selection").default(false),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("date_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),S=pgTable("formula_config",{id:varchar("id",{length:255}).primaryKey().$defaultFn(()=>"frm-"+ulid()),questionId:varchar("question_id",{length:255}).notNull().references(()=>t.id,{onDelete:"cascade"}),correctFormula:text("correct_formula"),variables:jsonb("variables"),allowedFunctions:text("allowed_functions").array().notNull(),tolerance:text("tolerance"),caseSensitive:boolean("case_sensitive").default(false),createdAt:timestamp("created_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`),updatedAt:timestamp("updated_at",{mode:"string",withTimezone:true}).notNull().default(sql`CURRENT_TIMESTAMP`).$onUpdate(()=>new Date().toISOString())},e=>({questionIdIndex:index("formula_question_idx").on(e.questionId),uniqueQuestion:unique().on(e.questionId)})),F=relations(t,({one:e,many:R})=>({testSession:e(testSession,{fields:[t.referenceId],references:[testSession.id],relationName:"testSession.question"}),textFieldConfig:e(_),fillBlankSegments:R(p),mediaConfig:e(T),sliderConfig:e(q),matchingPairs:R(I),matrixConfig:e(N),hotspotConfig:e(h),codeEditorConfig:e(x),dateTimeConfig:e(C),formulaConfig:e(S)})),O=relations(_,({one:e})=>({question:e(t,{fields:[_.questionId],references:[t.id],relationName:"question.textFieldConfig"})})),K=relations(p,({one:e})=>({question:e(t,{fields:[p.questionId],references:[t.id],relationName:"question.fillBlankSegments"})})),k=relations(T,({one:e})=>({question:e(t,{fields:[T.questionId],references:[t.id],relationName:"question.mediaConfig"})})),v=relations(q,({one:e})=>({question:e(t,{fields:[q.questionId],references:[t.id],relationName:"question.sliderConfig"})})),Q=relations(I,({one:e})=>({question:e(t,{fields:[I.questionId],references:[t.id],relationName:"question.matchingPairs"})})),b=relations(N,({one:e})=>({question:e(t,{fields:[N.questionId],references:[t.id],relationName:"question.matrixConfig"})})),B=relations(h,({one:e})=>({question:e(t,{fields:[h.questionId],references:[t.id],relationName:"question.hotspotConfig"})})),V=relations(x,({one:e})=>({question:e(t,{fields:[x.questionId],references:[t.id],relationName:"question.codeEditorConfig"})})),L=relations(C,({one:e})=>({question:e(t,{fields:[C.questionId],references:[t.id],relationName:"question.dateTimeConfig"})})),Y=relations(S,({one:e})=>({question:e(t,{fields:[S.questionId],references:[t.id],relationName:"question.formulaConfig"})}));export{x as codeEditorConfig,V as codeEditorConfigRelation,C as dateTimeConfig,L as dateTimeConfigRelation,p as fillBlankSegment,K as fillBlankSegmentRelation,S as formulaConfig,Y as formulaConfigRelation,h as hotspotConfig,B as hotspotConfigRelation,I as matchingPair,Q as matchingPairRelation,N as matrixConfig,b as matrixConfigRelation,T as mediaConfig,k as mediaConfigRelation,t as question,F as questionRelation,q as sliderConfig,v as sliderConfigRelation,_ as textFieldConfig,O as textFieldConfigRelation};//# sourceMappingURL=question.js.map
//# sourceMappingURL=question.js.map