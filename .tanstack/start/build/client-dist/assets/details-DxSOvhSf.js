const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/questions-teVL4-WO.js","assets/main-Cf9OxwIv.js","assets/badge-oBenMcsD.js","assets/question-type-JApPeNfu.js","assets/proxy-DpqCZSDj.js","assets/editor-DLIFMkF6.js","assets/index-GxXN4R5W.js","assets/index-tmSglm_A.js","assets/Combination-BQk3dayN.js","assets/index-CQ75r9EK.js","assets/index-C38j2yiJ.js","assets/input-CmcoE0j1.js","assets/label-D8wDE7WX.js","assets/chevron-down-jKp8XsSb.js","assets/editor-CwNmNxhW.css","assets/file-text-BXbKjMWl.js","assets/clock-D9d1ag9F.js","assets/calendar-BU_PnCKU.js","assets/dialog-CS9lxA6o.js","assets/x-D7PiG2td.js","assets/trash-2-aMbAjlot.js","assets/check-Bn16OikD.js","assets/tabs-LM7eqQvC.js","assets/index-D0TJhYiI.js","assets/plus-CXSvhfCS.js","assets/lock-BJ0pdqMX.js","assets/skeleton-DWmK6kTR.js","assets/text-shimmer-BJUA6AoE.js","assets/textarea-COU2Zv26.js","assets/arrow-right-eVV4FomT.js","assets/dialog-delete-test-DNxnMe0r.js","assets/separator-CaSlYSmw.js","assets/results-CEPqCCNO.js","assets/dropdown-menu-B_F-BED-.js","assets/progress-C-6GW6wE.js","assets/users-DowErYqb.js","assets/chart-column-BYV6ywXj.js","assets/circle-check-big-B3vhpd_W.js"])))=>i.map(i=>d[i]);
import{d as G,h as P,g as w,r as C,f as T,j as e,B as N,_ as et,k as H,C as _,$ as L,i as X,V as Ie,b as q,t as D,e as ie,P as me,R,Q as tt,a0 as st,N as it,a1 as Se}from"./main-Cf9OxwIv.js";import{a as Re,b as F,T as Me,c as U}from"./tabs-LM7eqQvC.js";import{S as I}from"./skeleton-DWmK6kTR.js";import{I as fe}from"./input-CmcoE0j1.js";import{T as ne,u as ge,P as ze,a as Pe,b as Ae,L as rt,c as nt,C as lt,d as Ce,E as ot,e as at,I as ct}from"./editor-DLIFMkF6.js";import{T as Te}from"./text-shimmer-BJUA6AoE.js";import{B as Le}from"./badge-oBenMcsD.js";import{D as K,a as Z,b as J,c as W,d as ee,e as te,f as se,g as pe}from"./dialog-CS9lxA6o.js";import{L as Oe}from"./lock-BJ0pdqMX.js";import{T as dt}from"./trash-2-aMbAjlot.js";import{L as Q}from"./label-D8wDE7WX.js";import{T as ht}from"./textarea-COU2Zv26.js";import{C as ce}from"./check-Bn16OikD.js";import{C as ut}from"./chevron-down-jKp8XsSb.js";import{A as mt}from"./arrow-right-eVV4FomT.js";import{P as ft}from"./plus-CXSvhfCS.js";import{C as gt,D as pt,P as xt}from"./dialog-delete-test-DNxnMe0r.js";import{S as _e}from"./separator-CaSlYSmw.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],vt=G("circle-stop",jt);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],de=G("copy",wt);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Nt=G("download",yt);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],bt=G("pencil",Ct);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],It=G("save",Et),St=({onPublished:a,test:n})=>{const r=P(w.organizer.testSection.getByTestId,{testId:n._id}),[l,h]=C.useState(!1),c=T(w.organizer.test.updateTest).withOptimisticUpdate((t,s)=>{const i=t.getQuery(w.organizer.test.getTestById,{testId:s.testId});i&&t.setQuery(w.organizer.test.getTestById,{testId:s.testId},{...i,...s.data})}),u=C.useMemo(()=>r==null?void 0:r.filter(t=>!t.numOfQuestions),[r]),p=()=>{c({testId:n._id,data:{access:n.access,isPublished:!0,type:n.type,title:n.title,description:n.description,showResultImmediately:n.showResultImmediately}}),a==null||a()};return e.jsxs(K,{open:l,onOpenChange:h,children:[e.jsx(Z,{asChild:!0,children:e.jsx(N,{children:"Publish"})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Publish test"}),e.jsx(te,{children:u!=null&&u.length&&(u==null?void 0:u.length)>0?"This test can be published after all sections have questions":"Are you sure you want to publish this test?"})]}),u&&(u==null?void 0:u.length)>0&&e.jsxs("div",{className:"bg-secondary p-3 rounded-md",children:[e.jsxs("h1",{className:"flex flex-row gap-2 items-center",children:[e.jsx(et,{className:"size-4"})," There are some sections that have no questions:"," "]}),e.jsx("ul",{className:"flex flex-col gap-2 mt-2",children:u.map(t=>e.jsxs("li",{className:"font-medium",children:["- ",t.title||`Section ${t.order}`]},t._id))})]}),e.jsxs(se,{children:[e.jsx(pe,{asChild:!0,children:e.jsx(N,{variant:"outline",children:"Cancel"})}),e.jsxs(N,{disabled:u&&(u==null?void 0:u.length)>0,onClick:p,children:[u&&(u==null?void 0:u.length)>0?e.jsx(Oe,{}):null,"Publish"]})]})]})]})},Rt=({onUnpublished:a,test:n})=>{const[r,l]=C.useState(!1),h=T(w.organizer.test.updateTest).withOptimisticUpdate((u,p)=>{const t=u.getQuery(w.organizer.test.getTestById,{testId:p.testId});t&&u.setQuery(w.organizer.test.getTestById,{testId:p.testId},{...t,...p.data})}),c=()=>{h({testId:n._id,data:{access:n.access,isPublished:!0,finishedAt:Date.now(),type:n.type,title:n.title,description:n.description,showResultImmediately:n.showResultImmediately}}),a==null||a()};return e.jsxs(K,{open:r,onOpenChange:l,children:[e.jsx(Z,{asChild:!0,children:e.jsxs(N,{variant:"outline",children:[e.jsx(vt,{})," Stop test"]})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Stop test"}),e.jsx(te,{children:"Are you sure you want to stop this test?"})]}),e.jsxs(se,{children:[e.jsx(pe,{asChild:!0,children:e.jsx(N,{variant:"outline",children:"Cancel"})}),e.jsx(N,{onClick:c,children:"Yes, Stop test"})]})]})]})},Mt=({className:a,sectionId:n,isLastSection:r=!1,testId:l,onDelete:h})=>{const[c,u]=C.useState(!1),p=T(w.organizer.testSection.remove).withOptimisticUpdate((s,i)=>{const o=s.getQuery(w.organizer.testSection.getByTestId,{testId:l});o&&s.setQuery(w.organizer.testSection.getByTestId,{testId:l},o.filter(d=>d._id!==i.sectionId))}),t=async()=>{await p({sectionId:n}),h==null||h(),u(!1)};return e.jsxs(K,{open:c,onOpenChange:u,children:[e.jsx(Z,{asChild:!0,children:e.jsx("div",{children:e.jsx(ne,{message:"Delete section",children:e.jsx(N,{size:"icon",variant:"ghost",className:H(a),onClick:s=>{s.stopPropagation(),u(!0)},children:e.jsx(dt,{})})})})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Delete section"}),e.jsx(te,{children:"Are you sure you want to delete this section?"})]}),r&&e.jsx("span",{className:"text-sm text-muted-foreground bg-secondary p-2 rounded-md",children:"This is the last section, you cannot delete it."}),e.jsxs(se,{children:[e.jsx(N,{variant:"secondary",onClick:()=>u(!1),children:"Back"}),e.jsx(N,{variant:"destructive",disabled:r,onClick:t,children:"Delete"})]})]})]})},zt=({testSection:a})=>{const[n,r]=C.useState(!1),l=T(w.organizer.testSection.update),{register:h,handleSubmit:c,reset:u,formState:{isDirty:p}}=ge();C.useEffect(()=>{a&&u(a)},[a,u]);const t=s=>{l({sectionId:a._id,data:{title:s.title}}),r(!1)};return e.jsxs(K,{open:n,onOpenChange:r,children:[e.jsx(Z,{asChild:!0,children:e.jsx(ne,{message:"Edit section",children:e.jsx(N,{size:"icon",variant:"ghost",onClick:()=>{r(!0)},children:e.jsx(bt,{})})})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"Edit section detail"}),e.jsx(te,{className:"hidden"})]}),e.jsxs("form",{onSubmit:c(t),className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(Q,{children:"Title"}),e.jsx(fe,{placeholder:"Type section's title here...",...h("title")})]}),e.jsxs("div",{className:"hidden flex-col gap-2",children:[e.jsx(Q,{children:"Description (Optional)"}),e.jsx(ht,{placeholder:"Type section's description here...",...h("description")})]}),e.jsxs(se,{className:"mt-0",children:[e.jsx(N,{onClick:()=>{r(!1)},variant:"secondary",children:"Back"}),e.jsx(N,{disabled:!p,type:"submit",children:"Save & exit"})]})]})]})]})},Pt=({data:a,isSelected:n,onClick:r})=>a?e.jsxs(_,{onClick:r,className:H("flex flex-col group/section justify-start   p-3 relative select-none bg-card",n?"border-primary border":"hover:bg-secondary"),children:[n?e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(ce,{size:16})}):null,e.jsxs("span",{className:"text-sm font-medium",children:[a.order,". ",a.title||`Section ${a.order}`]}),e.jsx("div",{className:"text-xs mt-1 flex flex-row gap-3 flex-wrap",children:e.jsxs("span",{className:"border px-2 py-0.5 rounded-full",children:[JSON.stringify(a.numOfQuestions)," Questions"]})})]},a._id):null,At=({className:a})=>{const[n,r]=C.useState(!1),{selectedSection:l,tabs:h,testId:c,resultsTab:u}=L({from:"/(organizer)/app/tests/details"}),p=X({from:"/app/tests/details"}),t=P(w.organizer.testSection.getByTestId,{testId:c}),s=C.useMemo(()=>!l||!t?null:t.find(i=>i._id===l),[l,t]);return t===void 0?e.jsx("div",{className:"flex flex-row gap-2 items-center",children:e.jsx(I,{className:"w-40 h-8 rounded-md"})}):(t==null?void 0:t.length)===1?e.jsx(be,{testId:c}):e.jsxs("div",{className:"flex flex-row-reverse md:flex-row gap-2 items-center",children:[e.jsx(Mt,{onDelete:()=>{p({search:{tabs:h,testId:c,selectedSection:void 0,resultsTab:u},replace:!0})},testId:c,isLastSection:(t==null?void 0:t.length)===1,sectionId:l}),s&&e.jsx(zt,{testSection:s}),e.jsx(be,{testId:c}),e.jsxs("div",{className:H("flex flex-row",a),children:[e.jsx(N,{onClick:()=>{const i=s==null?void 0:s.order;if(!i||i===1)return;const o=t==null?void 0:t.find(d=>d.order===i-1);o&&p({search:{tabs:h,testId:c,selectedSection:o._id,resultsTab:u},replace:!0})},disabled:(s==null?void 0:s.order)===1,variant:"outline",size:"icon",className:"border-r-0 rounded-r-none",children:e.jsx(Ie,{})}),e.jsxs(ze,{open:n,onOpenChange:r,children:[e.jsx(Pe,{asChild:!0,children:e.jsx("div",{children:e.jsx(ne,{message:"Click to check all sections",children:e.jsxs(N,{variant:"outline",className:"rounded-r-none rounded-l-none group",children:[s!=null&&s.title?e.jsxs(e.Fragment,{children:[s.order,". ",s.title]}):`Section ${s==null?void 0:s.order}`,s!=null&&s.duration&&(s==null?void 0:s.duration)>0?e.jsxs(Le,{variant:"secondary",children:[s.duration,"m"]}):null,e.jsx(ut,{className:H(n?"rotate-180":"")})]})})})}),e.jsx(Ae,{className:"p-2 bg-background",children:e.jsx(Tt,{testId:c})})]}),e.jsx(N,{onClick:()=>{const i=s==null?void 0:s.order;if(!i||i===(t==null?void 0:t.length))return;const o=t==null?void 0:t.find(d=>d.order===i+1);o&&p({search:{tabs:h,testId:c,selectedSection:o._id,resultsTab:u},replace:!0})},disabled:(s==null?void 0:s.order)===(t==null?void 0:t.length),variant:"outline",size:"icon",className:"rounded-l-none border-l-0",children:e.jsx(mt,{})})]})]})},Tt=({testId:a})=>{const{selectedSection:n,tabs:r,resultsTab:l}=L({from:"/(organizer)/app/tests/details"}),h=X({from:"/app/tests/details"}),c=P(w.organizer.testSection.getByTestId,{testId:a}),[u,p]=C.useState([]);return C.useEffect(()=>{c&&p(c)},[c]),c===void 0?e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx(I,{className:"w-full h-20"}),e.jsx(I,{className:"w-full h-20"}),e.jsx(I,{className:"w-full h-20"}),e.jsx(I,{className:"w-full h-20"})]}):!c||!c.length||!u?e.jsx("div",{children:"No session found"}):e.jsx("div",{className:"max-h-[60vh] overflow-y-auto flex flex-col gap-1",children:u==null?void 0:u.map(t=>e.jsx(Pt,{data:t,isSelected:t._id===n,onClick:()=>{h({search:{tabs:r,testId:a,selectedSection:t._id,resultsTab:l},replace:!0})}},t._id))})},be=({testId:a})=>{const{tabs:n,resultsTab:r}=L({from:"/(organizer)/app/tests/details"}),l=X({from:"/app/tests/details"}),h=P(w.organizer.testSection.getByTestId,{testId:a}),[c,u]=C.useState(!1),p=T(w.organizer.testSection.create),t=async()=>{u(!0);const s=await p({testId:a});l({search:{tabs:n,testId:a,selectedSection:s,resultsTab:r},replace:!0}),u(!1)};return e.jsx(ne,{message:"Add another section",children:e.jsx(N,{variant:h!=null&&h.length&&h.length>1?"ghost":"outline",size:h!=null&&h.length&&h.length>1?"icon":"default",disabled:c,onClick:t,children:c?e.jsx(q,{className:"animate-spin"}):e.jsxs(e.Fragment,{children:[e.jsx(ft,{className:"size-4"}),h!=null&&h.length&&h.length>1?null:"Add Multi-section"]})})})},Lt=({dataTest:a,onReopened:n})=>{const[r,l]=C.useState(!1),h=T(w.organizer.test.duplicateTest);return e.jsxs(K,{children:[e.jsx(Z,{asChild:!0,children:e.jsxs(N,{variant:"secondary",children:[e.jsx(de,{}),"Duplicate test"]})}),e.jsxs(J,{children:[e.jsxs(W,{children:[e.jsx(ee,{children:"You are about to duplicate the test."}),e.jsx(te,{children:"This action will create a completely new test with the same questions and settings."})]}),e.jsxs(se,{children:[e.jsx(pe,{asChild:!0,children:e.jsx(N,{variant:"outline",children:"Cancel"})}),e.jsxs(N,{variant:"default",onClick:()=>{a!==void 0&&(l(!0),h({testId:a._id}).then(c=>{n(c),l(!1)}))},disabled:a===void 0||r,children:[a===void 0||r?e.jsx(q,{className:"animate-spin"}):null,"Duplicate test"]})]})]})]})},Ot=()=>e.jsxs("div",{className:"flex flex-col space-y-10",children:[e.jsx(_t,{}),e.jsx(kt,{})]}),_t=()=>{const a=X(),{testId:n,resultsTab:r}=L({from:"/(organizer)/app/tests/details"}),l=P(w.organizer.test.getTestById,{testId:n}),h=()=>{navigator.clipboard.writeText(`${window.location.origin}/s/${l==null?void 0:l._id}`),D.success("Link copied to clipboard")},c=C.useMemo(()=>l!=null&&l.isPublished&&(l!=null&&l.finishedAt)?"finished":l!=null&&l.isPublished&&!(l!=null&&l.finishedAt)?"active":"draft",[l]);return e.jsxs("div",{className:"flex md:flex-row flex-col-reverse gap-2 justify-between items-center bg-card",children:[e.jsxs("div",{className:"flex flex-row gap-3 items-center",children:[e.jsx(N,{variant:"secondary",size:"icon-sm",onClick:()=>{a({to:"/app"})},rounded:!1,children:e.jsx(Ie,{})}),e.jsx(Bt,{})]}),l?e.jsxs("div",{className:"flex flex-row gap-3 items-center",children:[e.jsxs(Le,{size:"lg",className:"capitalize gap-2",variant:c==="draft"?"secondary":c==="active"?"ghost":"success",children:[c==="active"?e.jsx(gt,{className:"fill-emerald-500 stroke-emerald-500 max-w-2.5"}):null,c]}),e.jsx(_e,{orientation:"vertical",className:"h-4"}),c==="active"?e.jsx(N,{variant:"ghost",size:"icon",onClick:h,children:e.jsx(rt,{})}):null,c==="finished"?e.jsx(Lt,{dataTest:l,onReopened:u=>{a({from:"/app/tests/details",search:{testId:u,tabs:"questions",resultsTab:r}})}}):null,c==="draft"?e.jsx(St,{test:l,onPublished:()=>{a({from:"/app/tests/details",search:{testId:n,tabs:"results",resultsTab:r}})}}):null,c==="active"?e.jsx(Rt,{test:l,onUnpublished:()=>{a({to:"/app/tests/details",search:{testId:n,tabs:"results",resultsTab:r}})}}):null,e.jsx(pt,{variant:"destructive",size:"icon",testId:n,onDelete:()=>{a({to:"/app"})}})]}):e.jsx(I,{className:"w-24 h-8"})]})},kt=()=>{const{testId:a,tabs:n}=L({from:"/(organizer)/app/tests/details"}),r=P(w.organizer.test.getTestById,{testId:a}),l=C.useMemo(()=>r!=null&&r.isPublished&&(r!=null&&r.finishedAt)?"finished":r!=null&&r.isPublished&&!(r!=null&&r.finishedAt)?"active":"draft",[r]);return r===void 0?e.jsx("div",{children:e.jsx(Te,{className:"h-9",children:"Loading..."})}):e.jsxs("div",{className:"flex flex-row gap-2 items-center justify-between",children:[e.jsxs(Re,{children:[e.jsx(F,{value:"results",className:l==="draft"?"hidden":"",children:"Results"}),e.jsx(F,{value:"questions",children:"Questions"}),e.jsx(F,{value:"share",className:l==="draft"?"hidden":"",children:"Share"}),e.jsx(F,{value:"settings",children:"Settings"})]}),n==="questions"?e.jsx(At,{}):null]})},Bt=()=>{const[a,n]=C.useState(!1),{testId:r}=L({from:"/(organizer)/app/tests/details"}),l=P(w.organizer.test.getTestById,{testId:r}),{register:h,reset:c,getValues:u}=ge(),p=T(w.organizer.test.updateTest).withOptimisticUpdate((s,i)=>{const o=s.getQuery(w.organizer.test.getTestById,{testId:i.testId});o&&s.setQuery(w.organizer.test.getTestById,{testId:i.testId},{...o,...i.data})}),t=s=>{l!=null&&l._id&&p({testId:l==null?void 0:l._id,data:{title:s.title,access:s.access,showResultImmediately:s.showResultImmediately,isPublished:s.isPublished,type:s.type,description:s.description||""}})};return C.useEffect(()=>{l&&c(l)},[l,c]),l===void 0?e.jsx(Te,{className:"animate-pulse",children:"Loading..."}):e.jsxs(ze,{open:a,onOpenChange:n,children:[e.jsxs(Pe,{className:"flex flex-row items-center gap-2  group hover:opacity-80",children:[e.jsx("span",{className:H("w-max max-w-xl truncate",l!=null&&l.title?"":"text-muted-foreground"),children:(l==null?void 0:l.title)||"Name your test"}),l===void 0?e.jsx(q,{className:"animate-spin text-muted-foreground/50"}):e.jsx(xt,{className:"size-4 text-muted-foreground/50 group-hover:text-muted-foreground "})]}),e.jsx(nt,{children:e.jsx(Ae,{side:"bottom",align:"start",sideOffset:10,alignOffset:-10,children:e.jsxs("form",{onSubmit:s=>{s.preventDefault(),t(u()),n(!1)},children:[e.jsx(fe,{type:"text",...h("title"),className:"outline-none font-medium",placeholder:l===void 0?"Loading...":"Test title",disabled:l===void 0}),e.jsxs(N,{variant:"secondary",size:"sm",className:"w-max mt-2",type:"submit",children:[l===void 0?e.jsx(q,{className:"animate-spin"}):e.jsx(It,{className:"size-3.5"}),"Save"]})]})})})]})};function Dt({rows:a=5,columns:n=4}){return e.jsx("div",{className:"w-full",children:e.jsxs("div",{className:"rounded-md border",children:[e.jsx("div",{className:"border-b p-4",children:e.jsx("div",{className:"flex gap-4",children:Array.from({length:n}).map((r,l)=>e.jsx(I,{className:"h-4 flex-1"},l))})}),Array.from({length:a}).map((r,l)=>e.jsx("div",{className:"border-b p-4",children:e.jsx("div",{className:"flex gap-4",children:Array.from({length:n}).map((h,c)=>e.jsx(I,{className:"h-4 flex-1"},c))})},l))]})})}function Ft(){return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:Array.from({length:4}).map((a,n)=>e.jsx(_,{children:e.jsxs(ie,{className:"p-6",children:[e.jsx(I,{className:"h-6 w-16 mb-2"}),e.jsx(I,{className:"h-4 w-3/4"})]})},n))}),e.jsxs(_,{children:[e.jsx(me,{children:e.jsx(I,{className:"h-6 w-1/3"})}),e.jsx(ie,{children:e.jsx(I,{className:"h-64 w-full"})})]}),e.jsx(Dt,{rows:6,columns:5})]})}function Ut(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(I,{className:"h-4 w-1/6"}),e.jsx(I,{className:"h-32 w-full"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(I,{className:"h-4 w-1/4"}),Array.from({length:4}).map((a,n)=>e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(I,{className:"h-10 flex-1"}),e.jsx(I,{className:"h-8 w-8"})]},n))]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(I,{className:"h-10 w-24"}),e.jsx(I,{className:"h-10 w-20"})]})]})}function Qt({title:a="Loading...",description:n,className:r}){return e.jsxs("div",{className:H("flex flex-col items-center justify-center p-8 text-center",r),children:[e.jsx(q,{className:"h-8 w-8 animate-spin mb-4 text-gray-400"}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1",children:a}),n&&e.jsx("p",{className:"text-sm text-gray-500",children:n})]})}const ae=({title:a,description:n,children:r})=>e.jsx("div",{className:"py-4 first:pt-0 last:pb-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[240px_1fr] gap-20",children:[e.jsxs("div",{className:"flex flex-row gap-2 flex-wrap items-start",children:[e.jsx("h2",{className:"text-sm font-semibold",children:a}),e.jsx(at,{size:"icon-xs",variant:"ghost",className:"text-muted-foreground",children:n})]}),e.jsx("div",{className:"w-full flex flex-col gap-4",children:r})]})}),$t=()=>{const{testId:a}=L({from:"/(organizer)/app/tests/details"}),n=P(w.organizer.test.getTestById,{testId:a}),r=T(w.organizer.test.updateTest).withOptimisticUpdate((t,s)=>{const i=t.getQuery(w.organizer.test.getTestById,{testId:s.testId});i&&t.setQuery(w.organizer.test.getTestById,{testId:s.testId},{...i,...s.data})}),{reset:l,control:h,formState:{isDirty:c},handleSubmit:u}=ge();C.useEffect(()=>{n&&l(n)},[n,l]);const p=t=>{n!=null&&n._id&&r({testId:n==null?void 0:n._id,data:{type:t.type,title:t.title,access:t.access,showResultImmediately:t.showResultImmediately,isPublished:t.isPublished,description:t.description||""}})};return n===void 0?e.jsx(I,{className:"w-full h-[80dvh]"}):e.jsx("form",{onSubmit:u(p),children:e.jsxs(_,{className:"flex flex-col divide-y divide-dashed mb-10",children:[e.jsxs(me,{className:"flex flex-row items-center justify-between gap-4",children:[e.jsx("h1",{className:"font-medium",children:"Test Settings"}),e.jsx(N,{disabled:!c,type:"submit",variant:c?"default":"outline",children:"Save Changes"})]}),e.jsxs(ie,{children:[e.jsx(ae,{title:"Type",description:"Select the type of test you want to create",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(_,{className:"w-full p-3 border-foreground  relative",children:[e.jsx(lt,{size:18,className:"absolute top-2 right-2"}),e.jsx("h3",{className:"font-medium mb-2",children:"Self-Paced Test"}),e.jsx(Q,{className:"font-normal",children:"Self-paced tests allow candidates to take the test at their own pace, without any time constraints."})]}),e.jsxs(_,{className:"w-full p-3 opacity-70 ring-offset-4 ring-foreground/50 transition-all relative",children:[e.jsx(Oe,{size:18,className:"absolute top-2 right-2 opacity-50"}),e.jsx("h3",{className:"font-medium mb-2",children:"Live Test"}),e.jsx(Q,{className:"font-normal",children:"Live tests are timed and candidates must complete the test within a specific time limit."})]})]})}),e.jsx(ae,{title:"Show Result Immediately",description:"Select whether the test results should be shown immediately after the test is completed.",children:e.jsx(Ce,{name:"showResultImmediately",control:h,defaultValue:!0,render:({field:t})=>e.jsx(e.Fragment,{children:e.jsxs(Me,{className:"w-full",defaultValue:t.value?"true":"false",value:t.value?"true":"false",onValueChange:s=>{t.onChange(s==="true")},children:[e.jsxs(Re,{children:[e.jsx(F,{value:"true",children:"Yes"}),e.jsx(F,{value:"false",children:"No"})]}),e.jsx(U,{value:"true",children:e.jsx(Q,{className:"text-sm font-normal text-muted-foreground block",children:"Results will be shown immediately after the test is completed."})}),e.jsx(U,{value:"false",children:e.jsx(Q,{className:"text-sm font-normal text-muted-foreground block",children:"Results can only be viewed if organizer has published the results."})})]})})})}),e.jsx(ae,{title:"Description",description:"Enter a description for the test",children:e.jsx(Ce,{name:"description",control:h,render:({field:t})=>e.jsx(ot,{placeholder:"Enter a description for the test",value:t.value||"",onChange:t.onChange})})})]})]})})};var Ht=Object.defineProperty,re=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,Be=Object.prototype.propertyIsEnumerable,Ee=(a,n,r)=>n in a?Ht(a,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[n]=r,he=(a,n)=>{for(var r in n||(n={}))ke.call(n,r)&&Ee(a,r,n[r]);if(re)for(var r of re(n))Be.call(n,r)&&Ee(a,r,n[r]);return a},ue=(a,n)=>{var r={};for(var l in a)ke.call(a,l)&&n.indexOf(l)<0&&(r[l]=a[l]);if(a!=null&&re)for(var l of re(a))n.indexOf(l)<0&&Be.call(a,l)&&(r[l]=a[l]);return r};/**
 * @license QR Code generator library (TypeScript)
 * Copyright (c) Project Nayuki.
 * SPDX-License-Identifier: MIT
 */var k;(a=>{const n=class v{constructor(t,s,i,o){if(this.version=t,this.errorCorrectionLevel=s,this.modules=[],this.isFunction=[],t<v.MIN_VERSION||t>v.MAX_VERSION)throw new RangeError("Version value out of range");if(o<-1||o>7)throw new RangeError("Mask value out of range");this.size=t*4+17;let d=[];for(let m=0;m<this.size;m++)d.push(!1);for(let m=0;m<this.size;m++)this.modules.push(d.slice()),this.isFunction.push(d.slice());this.drawFunctionPatterns();const f=this.addEccAndInterleave(i);if(this.drawCodewords(f),o==-1){let m=1e9;for(let x=0;x<8;x++){this.applyMask(x),this.drawFormatBits(x);const g=this.getPenaltyScore();g<m&&(o=x,m=g),this.applyMask(x)}}h(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(t,s){const i=a.QrSegment.makeSegments(t);return v.encodeSegments(i,s)}static encodeBinary(t,s){const i=a.QrSegment.makeBytes(t);return v.encodeSegments([i],s)}static encodeSegments(t,s,i=1,o=40,d=-1,f=!0){if(!(v.MIN_VERSION<=i&&i<=o&&o<=v.MAX_VERSION)||d<-1||d>7)throw new RangeError("Invalid value");let m,x;for(m=i;;m++){const j=v.getNumDataCodewords(m,s)*8,S=u.getTotalBits(t,m);if(S<=j){x=S;break}if(m>=o)throw new RangeError("Data too long")}for(const j of[v.Ecc.MEDIUM,v.Ecc.QUARTILE,v.Ecc.HIGH])f&&x<=v.getNumDataCodewords(m,j)*8&&(s=j);let g=[];for(const j of t){r(j.mode.modeBits,4,g),r(j.numChars,j.mode.numCharCountBits(m),g);for(const S of j.getData())g.push(S)}h(g.length==x);const b=v.getNumDataCodewords(m,s)*8;h(g.length<=b),r(0,Math.min(4,b-g.length),g),r(0,(8-g.length%8)%8,g),h(g.length%8==0);for(let j=236;g.length<b;j^=253)r(j,8,g);let y=[];for(;y.length*8<g.length;)y.push(0);return g.forEach((j,S)=>y[S>>>3]|=j<<7-(S&7)),new v(m,s,y,d)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let i=0;i<this.size;i++)this.setFunctionModule(6,i,i%2==0),this.setFunctionModule(i,6,i%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let i=0;i<s;i++)for(let o=0;o<s;o++)i==0&&o==0||i==0&&o==s-1||i==s-1&&o==0||this.drawAlignmentPattern(t[i],t[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let i=s;for(let d=0;d<10;d++)i=i<<1^(i>>>9)*1335;const o=(s<<10|i)^21522;h(o>>>15==0);for(let d=0;d<=5;d++)this.setFunctionModule(8,d,l(o,d));this.setFunctionModule(8,7,l(o,6)),this.setFunctionModule(8,8,l(o,7)),this.setFunctionModule(7,8,l(o,8));for(let d=9;d<15;d++)this.setFunctionModule(14-d,8,l(o,d));for(let d=0;d<8;d++)this.setFunctionModule(this.size-1-d,8,l(o,d));for(let d=8;d<15;d++)this.setFunctionModule(8,this.size-15+d,l(o,d));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let i=0;i<12;i++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;h(s>>>18==0);for(let i=0;i<18;i++){const o=l(s,i),d=this.size-11+i%3,f=Math.floor(i/3);this.setFunctionModule(d,f,o),this.setFunctionModule(f,d,o)}}drawFinderPattern(t,s){for(let i=-4;i<=4;i++)for(let o=-4;o<=4;o++){const d=Math.max(Math.abs(o),Math.abs(i)),f=t+o,m=s+i;0<=f&&f<this.size&&0<=m&&m<this.size&&this.setFunctionModule(f,m,d!=2&&d!=4)}}drawAlignmentPattern(t,s){for(let i=-2;i<=2;i++)for(let o=-2;o<=2;o++)this.setFunctionModule(t+o,s+i,Math.max(Math.abs(o),Math.abs(i))!=1)}setFunctionModule(t,s,i){this.modules[s][t]=i,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,i=this.errorCorrectionLevel;if(t.length!=v.getNumDataCodewords(s,i))throw new RangeError("Invalid argument");const o=v.NUM_ERROR_CORRECTION_BLOCKS[i.ordinal][s],d=v.ECC_CODEWORDS_PER_BLOCK[i.ordinal][s],f=Math.floor(v.getNumRawDataModules(s)/8),m=o-f%o,x=Math.floor(f/o);let g=[];const b=v.reedSolomonComputeDivisor(d);for(let j=0,S=0;j<o;j++){let M=t.slice(S,S+x-d+(j<m?0:1));S+=M.length;const B=v.reedSolomonComputeRemainder(M,b);j<m&&M.push(0),g.push(M.concat(B))}let y=[];for(let j=0;j<g[0].length;j++)g.forEach((S,M)=>{(j!=x-d||M>=m)&&y.push(S[j])});return h(y.length==f),y}drawCodewords(t){if(t.length!=Math.floor(v.getNumRawDataModules(this.version)/8))throw new RangeError("Invalid argument");let s=0;for(let i=this.size-1;i>=1;i-=2){i==6&&(i=5);for(let o=0;o<this.size;o++)for(let d=0;d<2;d++){const f=i-d,x=(i+1&2)==0?this.size-1-o:o;!this.isFunction[x][f]&&s<t.length*8&&(this.modules[x][f]=l(t[s>>>3],7-(s&7)),s++)}}h(s==t.length*8)}applyMask(t){if(t<0||t>7)throw new RangeError("Mask value out of range");for(let s=0;s<this.size;s++)for(let i=0;i<this.size;i++){let o;switch(t){case 0:o=(i+s)%2==0;break;case 1:o=s%2==0;break;case 2:o=i%3==0;break;case 3:o=(i+s)%3==0;break;case 4:o=(Math.floor(i/3)+Math.floor(s/2))%2==0;break;case 5:o=i*s%2+i*s%3==0;break;case 6:o=(i*s%2+i*s%3)%2==0;break;case 7:o=((i+s)%2+i*s%3)%2==0;break;default:throw new Error("Unreachable")}!this.isFunction[s][i]&&o&&(this.modules[s][i]=!this.modules[s][i])}}getPenaltyScore(){let t=0;for(let d=0;d<this.size;d++){let f=!1,m=0,x=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[d][g]==f?(m++,m==5?t+=v.PENALTY_N1:m>5&&t++):(this.finderPenaltyAddHistory(m,x),f||(t+=this.finderPenaltyCountPatterns(x)*v.PENALTY_N3),f=this.modules[d][g],m=1);t+=this.finderPenaltyTerminateAndCount(f,m,x)*v.PENALTY_N3}for(let d=0;d<this.size;d++){let f=!1,m=0,x=[0,0,0,0,0,0,0];for(let g=0;g<this.size;g++)this.modules[g][d]==f?(m++,m==5?t+=v.PENALTY_N1:m>5&&t++):(this.finderPenaltyAddHistory(m,x),f||(t+=this.finderPenaltyCountPatterns(x)*v.PENALTY_N3),f=this.modules[g][d],m=1);t+=this.finderPenaltyTerminateAndCount(f,m,x)*v.PENALTY_N3}for(let d=0;d<this.size-1;d++)for(let f=0;f<this.size-1;f++){const m=this.modules[d][f];m==this.modules[d][f+1]&&m==this.modules[d+1][f]&&m==this.modules[d+1][f+1]&&(t+=v.PENALTY_N2)}let s=0;for(const d of this.modules)s=d.reduce((f,m)=>f+(m?1:0),s);const i=this.size*this.size,o=Math.ceil(Math.abs(s*20-i*10)/i)-1;return h(0<=o&&o<=9),t+=o*v.PENALTY_N4,h(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let i=[6];for(let o=this.size-7;i.length<t;o-=s)i.splice(1,0,o);return i}}static getNumRawDataModules(t){if(t<v.MIN_VERSION||t>v.MAX_VERSION)throw new RangeError("Version number out of range");let s=(16*t+128)*t+64;if(t>=2){const i=Math.floor(t/7)+2;s-=(25*i-10)*i-55,t>=7&&(s-=36)}return h(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(v.getNumRawDataModules(t)/8)-v.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*v.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw new RangeError("Degree out of range");let s=[];for(let o=0;o<t-1;o++)s.push(0);s.push(1);let i=1;for(let o=0;o<t;o++){for(let d=0;d<s.length;d++)s[d]=v.reedSolomonMultiply(s[d],i),d+1<s.length&&(s[d]^=s[d+1]);i=v.reedSolomonMultiply(i,2)}return s}static reedSolomonComputeRemainder(t,s){let i=s.map(o=>0);for(const o of t){const d=o^i.shift();i.push(0),s.forEach((f,m)=>i[m]^=v.reedSolomonMultiply(f,d))}return i}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw new RangeError("Byte out of range");let i=0;for(let o=7;o>=0;o--)i=i<<1^(i>>>7)*285,i^=(s>>>o&1)*t;return h(i>>>8==0),i}finderPenaltyCountPatterns(t){const s=t[1];h(s<=this.size*3);const i=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(i&&t[0]>=s*4&&t[6]>=s?1:0)+(i&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,i){return t&&(this.finderPenaltyAddHistory(s,i),s=0),s+=this.size,this.finderPenaltyAddHistory(s,i),this.finderPenaltyCountPatterns(i)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};n.MIN_VERSION=1,n.MAX_VERSION=40,n.PENALTY_N1=3,n.PENALTY_N2=3,n.PENALTY_N3=40,n.PENALTY_N4=10,n.ECC_CODEWORDS_PER_BLOCK=[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]],n.NUM_ERROR_CORRECTION_BLOCKS=[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]],a.QrCode=n;function r(p,t,s){if(t<0||t>31||p>>>t)throw new RangeError("Value out of range");for(let i=t-1;i>=0;i--)s.push(p>>>i&1)}function l(p,t){return(p>>>t&1)!=0}function h(p){if(!p)throw new Error("Assertion error")}const c=class E{constructor(t,s,i){if(this.mode=t,this.numChars=s,this.bitData=i,s<0)throw new RangeError("Invalid argument");this.bitData=i.slice()}static makeBytes(t){let s=[];for(const i of t)r(i,8,s);return new E(E.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!E.isNumeric(t))throw new RangeError("String contains non-numeric characters");let s=[];for(let i=0;i<t.length;){const o=Math.min(t.length-i,3);r(parseInt(t.substring(i,i+o),10),o*3+1,s),i+=o}return new E(E.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!E.isAlphanumeric(t))throw new RangeError("String contains unencodable characters in alphanumeric mode");let s=[],i;for(i=0;i+2<=t.length;i+=2){let o=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i))*45;o+=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i+1)),r(o,11,s)}return i<t.length&&r(E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(i)),6,s),new E(E.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:E.isNumeric(t)?[E.makeNumeric(t)]:E.isAlphanumeric(t)?[E.makeAlphanumeric(t)]:[E.makeBytes(E.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw new RangeError("ECI assignment value out of range");if(t<128)r(t,8,s);else if(t<16384)r(2,2,s),r(t,14,s);else if(t<1e6)r(6,3,s),r(t,21,s);else throw new RangeError("ECI assignment value out of range");return new E(E.Mode.ECI,0,s)}static isNumeric(t){return E.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return E.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let i=0;for(const o of t){const d=o.mode.numCharCountBits(s);if(o.numChars>=1<<d)return 1/0;i+=4+d+o.bitData.length}return i}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let i=0;i<t.length;i++)t.charAt(i)!="%"?s.push(t.charCodeAt(i)):(s.push(parseInt(t.substring(i+1,i+3),16)),i+=2);return s}};c.NUMERIC_REGEX=/^[0-9]*$/,c.ALPHANUMERIC_REGEX=/^[A-Z0-9 $%*+.\/:-]*$/,c.ALPHANUMERIC_CHARSET="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:";let u=c;a.QrSegment=c})(k||(k={}));(a=>{(n=>{const r=class{constructor(h,c){this.ordinal=h,this.formatBits=c}};r.LOW=new r(0,1),r.MEDIUM=new r(1,0),r.QUARTILE=new r(2,3),r.HIGH=new r(3,2),n.Ecc=r})(a.QrCode||(a.QrCode={}))})(k||(k={}));(a=>{(n=>{const r=class{constructor(h,c){this.modeBits=h,this.numBitsCharCount=c}numCharCountBits(h){return this.numBitsCharCount[Math.floor((h+7)/17)]}};r.NUMERIC=new r(1,[10,12,14]),r.ALPHANUMERIC=new r(2,[9,11,13]),r.BYTE=new r(4,[8,16,16]),r.KANJI=new r(8,[8,10,12]),r.ECI=new r(7,[0,0,0]),n.Mode=r})(a.QrSegment||(a.QrSegment={}))})(k||(k={}));var $=k;/**
 * @license qrcode.react
 * Copyright (c) Paul O'Shannessy
 * SPDX-License-Identifier: ISC
 */var Vt={L:$.QrCode.Ecc.LOW,M:$.QrCode.Ecc.MEDIUM,Q:$.QrCode.Ecc.QUARTILE,H:$.QrCode.Ecc.HIGH},De=128,Fe="L",Ue="#FFFFFF",Qe="#000000",$e=!1,He=1,Yt=4,qt=0,Gt=.1;function Ve(a,n=0){const r=[];return a.forEach(function(l,h){let c=null;l.forEach(function(u,p){if(!u&&c!==null){r.push(`M${c+n} ${h+n}h${p-c}v1H${c+n}z`),c=null;return}if(p===l.length-1){if(!u)return;c===null?r.push(`M${p+n},${h+n} h1v1H${p+n}z`):r.push(`M${c+n},${h+n} h${p+1-c}v1H${c+n}z`);return}u&&c===null&&(c=p)})}),r.join("")}function Ye(a,n){return a.slice().map((r,l)=>l<n.y||l>=n.y+n.h?r:r.map((h,c)=>c<n.x||c>=n.x+n.w?h:!1))}function Xt(a,n,r,l){if(l==null)return null;const h=a.length+r*2,c=Math.floor(n*Gt),u=h/n,p=(l.width||c)*u,t=(l.height||c)*u,s=l.x==null?a.length/2-p/2:l.x*u,i=l.y==null?a.length/2-t/2:l.y*u,o=l.opacity==null?1:l.opacity;let d=null;if(l.excavate){let m=Math.floor(s),x=Math.floor(i),g=Math.ceil(p+s-m),b=Math.ceil(t+i-x);d={x:m,y:x,w:g,h:b}}const f=l.crossOrigin;return{x:s,y:i,h:t,w:p,excavation:d,opacity:o,crossOrigin:f}}function Kt(a,n){return n!=null?Math.max(Math.floor(n),0):a?Yt:qt}function qe({value:a,level:n,minVersion:r,includeMargin:l,marginSize:h,imageSettings:c,size:u,boostLevel:p}){let t=R.useMemo(()=>{const m=(Array.isArray(a)?a:[a]).reduce((x,g)=>(x.push(...$.QrSegment.makeSegments(g)),x),[]);return $.QrCode.encodeSegments(m,Vt[n],r,void 0,void 0,p)},[a,n,r,p]);const{cells:s,margin:i,numCells:o,calculatedImageSettings:d}=R.useMemo(()=>{let f=t.getModules();const m=Kt(l,h),x=f.length+m*2,g=Xt(f,u,m,c);return{cells:f,margin:m,numCells:x,calculatedImageSettings:g}},[t,u,c,l,h]);return{qrcode:t,margin:i,cells:s,numCells:o,calculatedImageSettings:d}}var Zt=function(){try{new Path2D().addPath(new Path2D)}catch{return!1}return!0}(),Jt=R.forwardRef(function(n,r){const l=n,{value:h,size:c=De,level:u=Fe,bgColor:p=Ue,fgColor:t=Qe,includeMargin:s=$e,minVersion:i=He,boostLevel:o,marginSize:d,imageSettings:f}=l,x=ue(l,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","marginSize","imageSettings"]),{style:g}=x,b=ue(x,["style"]),y=f==null?void 0:f.src,j=R.useRef(null),S=R.useRef(null),M=R.useCallback(O=>{j.current=O,typeof r=="function"?r(O):r&&(r.current=O)},[r]),[B,xe]=R.useState(!1),{margin:V,cells:le,numCells:oe,calculatedImageSettings:z}=qe({value:h,level:u,minVersion:i,boostLevel:o,includeMargin:s,marginSize:d,imageSettings:f,size:c});R.useEffect(()=>{if(j.current!=null){const O=j.current,A=O.getContext("2d");if(!A)return;let ve=le;const Y=S.current,we=z!=null&&Y!==null&&Y.complete&&Y.naturalHeight!==0&&Y.naturalWidth!==0;we&&z.excavation!=null&&(ve=Ye(le,z.excavation));const ye=window.devicePixelRatio||1;O.height=O.width=c*ye;const Ne=c/oe*ye;A.scale(Ne,Ne),A.fillStyle=p,A.fillRect(0,0,oe,oe),A.fillStyle=t,Zt?A.fill(new Path2D(Ve(ve,V))):le.forEach(function(Ke,Ze){Ke.forEach(function(Je,We){Je&&A.fillRect(We+V,Ze+V,1,1)})}),z&&(A.globalAlpha=z.opacity),we&&A.drawImage(Y,z.x+V,z.y+V,z.w,z.h)}}),R.useEffect(()=>{xe(!1)},[y]);const Xe=he({height:c,width:c},g);let je=null;return y!=null&&(je=R.createElement("img",{src:y,key:y,style:{display:"none"},onLoad:()=>{xe(!0)},ref:S,crossOrigin:z==null?void 0:z.crossOrigin})),R.createElement(R.Fragment,null,R.createElement("canvas",he({style:Xe,height:c,width:c,ref:M,role:"img"},b)),je)});Jt.displayName="QRCodeCanvas";var Ge=R.forwardRef(function(n,r){const l=n,{value:h,size:c=De,level:u=Fe,bgColor:p=Ue,fgColor:t=Qe,includeMargin:s=$e,minVersion:i=He,boostLevel:o,title:d,marginSize:f,imageSettings:m}=l,x=ue(l,["value","size","level","bgColor","fgColor","includeMargin","minVersion","boostLevel","title","marginSize","imageSettings"]),{margin:g,cells:b,numCells:y,calculatedImageSettings:j}=qe({value:h,level:u,minVersion:i,boostLevel:o,includeMargin:s,marginSize:f,imageSettings:m,size:c});let S=b,M=null;m!=null&&j!=null&&(j.excavation!=null&&(S=Ye(b,j.excavation)),M=R.createElement("image",{href:m.src,height:j.h,width:j.w,x:j.x+g,y:j.y+g,preserveAspectRatio:"none",opacity:j.opacity,crossOrigin:j.crossOrigin}));const B=Ve(S,g);return R.createElement("svg",he({height:c,width:c,viewBox:`0 0 ${y} ${y}`,ref:r,role:"img"},x),!!d&&R.createElement("title",null,d),R.createElement("path",{fill:p,d:`M0,0 h${y}v${y}H0z`,shapeRendering:"crispEdges"}),R.createElement("path",{fill:t,d:B,shapeRendering:"crispEdges"}),M)});Ge.displayName="QRCodeSVG";const Wt=({testId:a})=>{const[n,r]=C.useState(!1),l=C.useRef(null),h=42,c=P(w.organizer.test.getTestById,{testId:a}),u=()=>{navigator.clipboard.writeText(`${window.location.origin}/s/${a}`),D.success("Link copied to clipboard"),r(!0),setTimeout(()=>{r(!1)},2e3)},p=async()=>{if(!l.current)return;const s=l.current.querySelector("svg");if(!s)return;const i=document.createElement("canvas"),o=i.getContext("2d");if(!o)return;i.width=500,i.height=500;const d=document.createElement("img"),f=new XMLSerializer().serializeToString(s),m=new Blob([f],{type:"image/svg+xml;charset=utf-8"}),x=URL.createObjectURL(m);try{await new Promise((b,y)=>{d.onload=b,d.onerror=y,d.src=x}),o.fillStyle="white",o.fillRect(0,0,i.width,i.height),o.drawImage(d,0,0,i.width,i.height);const g=l.current.querySelector(".qr-logo");if(g&&g.complete){const b=(i.width-h*2)/2,y=(i.height-h*2)/2;o.drawImage(g,b,y,h*2,h*2)}i.toBlob(async b=>{if(b)try{await navigator.clipboard.write([new ClipboardItem({[b.type]:b})]),r(!0),D.success("QR Code image copied to clipboard",{position:"top-right"}),setTimeout(()=>{r(!1)},2e3)}catch(y){D.error("Failed to copy image. Your browser may not support this feature."),console.error("Clipboard write failed:",y)}},"image/png")}catch(g){D.error("Failed to generate QR code image"),console.error("Error generating QR code image:",g)}finally{URL.revokeObjectURL(x)}},t=()=>{if(!l.current)return;const s=l.current.querySelector("svg");if(!s)return;const i=document.createElement("canvas"),o=i.getContext("2d");if(!o)return;i.width=1e3,i.height=1e3;const d=document.createElement("img"),f=new XMLSerializer().serializeToString(s),m=new Blob([f],{type:"image/svg+xml;charset=utf-8"}),x=URL.createObjectURL(m);d.onload=()=>{var j;o.fillStyle="white",o.fillRect(0,0,i.width,i.height),o.drawImage(d,0,0,i.width,i.height);const g=(j=l.current)==null?void 0:j.querySelector(".qr-logo");if(g&&g.complete){const M=(i.width-250)/2,B=(i.height-250)/2;o.drawImage(g,M,B,250,250)}const b=i.toDataURL("image/png"),y=document.createElement("a");y.download=`${(c==null?void 0:c.title)||"test"}-qrcode.png`,y.href=b,y.click(),URL.revokeObjectURL(x)},d.src=x,D.success("QR Code downloaded",{position:"top-right"})};return e.jsx("div",{className:"space-y-8",children:e.jsxs(_,{className:"border",children:[e.jsxs(me,{className:"pb-2 border-b border-dashed",children:[e.jsx(tt,{children:"Share Test"}),e.jsx(st,{children:"Share your test with participants"})]}),e.jsx(ie,{children:e.jsxs("div",{className:"flex flex-col md:flex-row items-start gap-6",children:[e.jsxs("div",{className:"relative bg-background p-4 border",ref:l,children:[e.jsx(Ge,{value:`${window.location.origin}/s/${a}`,size:180,level:"H",includeMargin:!0,imageSettings:{src:"/images/logo.svg",x:void 0,y:void 0,height:h,width:h,excavate:!0}}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("img",{src:"/images/logo.svg",alt:"Logo",width:h,height:h,className:"qr-logo"})})]}),e.jsxs("div",{className:"flex flex-col items-center md:items-start space-y-4 flex-1",children:[e.jsxs("div",{className:"w-full space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full",children:[e.jsxs(N,{variant:"outline",className:"gap-2",onClick:t,children:[e.jsx(Nt,{className:"h-4 w-4"}),"Download QR Code"]}),e.jsxs(N,{variant:"secondary",className:"gap-2",onClick:p,children:[n?e.jsx(ce,{className:"h-4 w-4"}):e.jsx(de,{className:"h-4 w-4"}),n?"Copied!":"Copy QR"]})]}),e.jsx(_e,{})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(fe,{value:`${window.location.origin}/s/${a}`,readOnly:!0,className:"pr-10 font-mono text-sm"}),e.jsx(N,{variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full",onClick:u,children:n?e.jsx(ce,{className:"h-4 w-4 text-green-500"}):e.jsx(de,{className:"h-4 w-4"})})]}),e.jsx(N,{onClick:u,children:n?"Copied!":"Copy Link"})]}),e.jsxs("div",{className:"p-4 flex items-start gap-3 w-full",children:[e.jsx(ct,{className:"h-5 w-5 text-blue-500 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium",children:(c==null?void 0:c.access)==="private"?"Only invited participants can access this test":"Anyone with this link can access the test"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:(c==null?void 0:c.access)==="private"?"Share this link with participants after inviting them via email.":"Share this link directly with participants or use it in your communications."})]})]})]})]})})]})})},es=C.lazy(()=>Se(()=>import("./questions-teVL4-WO.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),ts=C.lazy(()=>Se(()=>import("./results-CEPqCCNO.js"),__vite__mapDeps([32,1,22,6,7,23,9,33,8,10,11,2,15,12,27,4,5,13,14,34,35,16,36,37,26,18,19,25,20,28,21,29,24,30,31])));function ss(){const{tabs:a,testId:n,selectedSection:r,resultsTab:l}=L({from:"/(organizer)/app/tests/details"}),h=P(w.organizer.test.getTestById,{testId:n}),c=X({from:"/app/tests/details"}),u=P(w.organizer.testSection.getByTestId,{testId:n});return C.useEffect(()=>{u!=null&&u.length&&!r&&a==="questions"&&c({search:{tabs:"questions",testId:n,selectedSection:u[0]._id,resultsTab:l},replace:!0})},[u,c,n,r,a]),h===null?e.jsx(it,{}):e.jsxs(Me,{value:a,onValueChange:p=>{c({search:{tabs:p,testId:n,selectedSection:r,resultsTab:l}})},children:[e.jsx(Ot,{}),e.jsxs("div",{className:"mt-2",children:[e.jsx(U,{value:"questions",children:r?e.jsx(C.Suspense,{fallback:e.jsx(Ut,{}),children:e.jsx(es,{selectedSectionId:r,testId:n})}):e.jsx(Qt,{title:"Loading section...",description:"Please wait while we load the questions"})}),e.jsx(U,{value:"results",children:e.jsx(C.Suspense,{fallback:e.jsx(Ft,{}),children:e.jsx(ts,{})})}),e.jsx(U,{value:"settings",children:e.jsx($t,{})}),e.jsx(U,{value:"share",children:e.jsx(Wt,{testId:n})})]})]})}const is=ss,bs=Object.freeze(Object.defineProperty({__proto__:null,component:is},Symbol.toStringTag,{value:"Module"}));export{Nt as D,bt as P,bs as d};
